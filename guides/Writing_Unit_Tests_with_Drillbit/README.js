Ext.data.JsonP['Writing_Unit_Tests_with_Drillbit']({"guide":"<?xml version='1.0' encoding='utf-8'?>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n        \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n<head>\n<title>Writing Unit Tests with Drillbit</title>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\n<meta content=\"Scroll EclipseHelp Exporter\" name=\"generator\" />\n<link type=\"text/css\" rel=\"stylesheet\" />\n<link type=\"text/css\" rel=\"stylesheet\" />\n<link type=\"text/css\" rel=\"stylesheet\" media=\"print\" />\n</head>\n<body>\n<div class=\"container\">\n<div class=\"header\"></div>\n<div id=\"29004751\" class=\"content\"><a id=\"editButton\" href=\"https://wiki.appcelerator.org/pages/editpage.action?pageId=29004751\"><span>Edit</span></a>\n<h1>Writing Unit Tests with Drillbit</h1>\n<div class=\"section section-2 \" id=\"29004751_WritingUnitTestswithDrillbit-Contents\">\n<h2 class=\"heading \"><span>Contents</span></h2>\n<ul class=\"toc-indentation \"><li class=\" \"> <p>\n<a class=\"document-link \" href=\"#!/guide/Writing_Unit_Tests_with_Drillbit-section-29004751_WritingUnitTestswithDrillbit-Overview\" Writing_Unit_Tests_with_Drillbit.html#29004751_WritingUnitTestswithDrillbit-Overview=\"Writing_Unit_Tests_with_Drillbit.html#29004751_WritingUnitTestswithDrillbit-Overview\">Overview</a> </p>\n</li><li class=\" \"> <p>\n<a class=\"document-link \" href=\"#!/guide/Writing_Unit_Tests_with_Drillbit-section-29004751_WritingUnitTestswithDrillbit-HowtowriteaDrillbittest\" Writing_Unit_Tests_with_Drillbit.html#29004751_WritingUnitTestswithDrillbit-HowtowriteaDrillbittest=\"Writing_Unit_Tests_with_Drillbit.html#29004751_WritingUnitTestswithDrillbit-HowtowriteaDrillbittest\">How to write a Drillbit test</a> </p>\n</li><li class=\" \"> <p>\n<a class=\"document-link \" href=\"#!/guide/Writing_Unit_Tests_with_Drillbit-section-29004751_WritingUnitTestswithDrillbit-Assertions\" Writing_Unit_Tests_with_Drillbit.html#29004751_WritingUnitTestswithDrillbit-Assertions=\"Writing_Unit_Tests_with_Drillbit.html#29004751_WritingUnitTestswithDrillbit-Assertions\">Assertions</a> </p>\n</li><li class=\" \"> <p>\n<a class=\"document-link \" href=\"#!/guide/Writing_Unit_Tests_with_Drillbit-section-29004751_WritingUnitTestswithDrillbit-AsynchronousTests\" Writing_Unit_Tests_with_Drillbit.html#29004751_WritingUnitTestswithDrillbit-AsynchronousTests=\"Writing_Unit_Tests_with_Drillbit.html#29004751_WritingUnitTestswithDrillbit-AsynchronousTests\">Asynchronous Tests</a> </p>\n</li><li class=\" \"> <p>\n<a class=\"document-link \" href=\"#!/guide/Writing_Unit_Tests_with_Drillbit-section-29004751_WritingUnitTestswithDrillbit-RunningDrillbit\" Writing_Unit_Tests_with_Drillbit.html#29004751_WritingUnitTestswithDrillbit-RunningDrillbit=\"Writing_Unit_Tests_with_Drillbit.html#29004751_WritingUnitTestswithDrillbit-RunningDrillbit\">Running Drillbit</a> </p>\n</li></ul> </div>\n<div class=\"section section-2 \" id=\"29004751_WritingUnitTestswithDrillbit-Overview\">\n<h2 class=\"heading \"><span>Overview</span></h2>\n<p>\nA unit testing framework, harness, and driver for Titanium    </p>\n</div>\n<div class=\"section section-2 \" id=\"29004751_WritingUnitTestswithDrillbit-HowtowriteaDrillbittest\">\n<h2 class=\"heading \"><span>How to write a Drillbit test</span></h2>\n<p>\nDrillbit resembles a JSSpec test and uses some of their conventions.    </p>\n<p>\nTo define a test suite, you have several options:    </p>\n<ul class=\" \"><li class=\" \"> <p>\nCreate a standalone Javascript file, For example, <tt class=\" \">foo.js</tt> under the <tt class=\" \">drillbit/tests</tt> folder would define a test suite for <tt class=\" \">foo</tt>.    </p>\n</li><li class=\" \"> <p>\nCreate a directory with a Javascript file using the same name under it. For example, <tt class=\" \">foo/foo.js</tt> under the <tt class=\" \">drillbit/tests</tt> folder would define a test suite for <tt class=\" \">foo</tt>.    </p>\n</li><li class=\" \"> <p>\nAny other resources under the test suite's directory will be recursively copied into the Test Harness application's root before it is deployed    </p>\n</li><li class=\" \"> <p>\nFor platform specific test suites, create either of the above under one of the special platform directories. For example, <tt class=\" \">android/foo.js</tt> would define a test suite for <tt class=\" \">foo</tt> that only ran on the Android emulator.    </p>\n</li></ul> <p>\nYou can also specify extra test directories for Drillbit to pull test suites from by using the <tt class=\" \">--tests-dir</tt> argument. See the <strong class=\" \">Running Drillbit</strong> section below.    </p>\n<p>\nIn a test suite's Javascript file, you simply need to call the Drillbit function <tt class=\" \">describe</tt> to give a description and test spec for your test suite. For example, a simple math test suite with just two tests might look like:    </p>\n<div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"confbox programlisting scroll-unprocessed\">\n<div class=\"defaultnew syntaxhighlighter\">\n<div class=\"line\"><code class=\"plain\">describe(</code><code class=\"string\">\"test simple math\"</code><code class=\"plain\">, {</code></div>\n<div class=\"line\"><code class=\"plain\">  testAdd: function() {</code></div>\n<div class=\"line\"><code class=\"plain\">    valueOf(</code><code class=\"value\">1</code><code class=\"plain\">+</code><code class=\"value\">1</code><code class=\"plain\">).shouldBe(</code><code class=\"value\">2</code><code class=\"plain\">);</code></div>\n<div class=\"line\"><code class=\"plain\">  },</code></div>\n<div class=\"line\"><code class=\"plain\">  testSubtract: function() {</code></div>\n<div class=\"line\"><code class=\"plain\">    valueOf(</code><code class=\"value\">2</code><code class=\"plain\">-</code><code class=\"value\">1</code><code class=\"plain\">).shouldBe(</code><code class=\"value\">1</code><code class=\"plain\">);</code></div>\n<div class=\"line\"><code class=\"plain\">  }</code></div>\n<div class=\"line\"><code class=\"plain\">});</code></div>\n</div>\n</div> <p>\nThe first parameter is the description for your test, and the second parameter is your test spec. Any functions inside the test spec are considered tests to be run by Drillbit.    </p>\n<p>\nOptionally, you may also define these special functions inside your test spec:    </p>\n<div class=\"tablewrap\">\n<table class=\"confluenceTable\">\n<thead class=\" \"></thead><tfoot class=\" \"></tfoot><tbody class=\" \"> <tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nbefore_all    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nCalled before all tests are run    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nafter_all    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nCalled after all tests are run    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nbefore    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nCalled before each and every test method    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nafter    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nCalled after each and every test method    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\ntimeout    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nproperty in milliseconds for the max time a test should take    </p>\n</td>\n</tr>\n</tbody> </table>\n</div>\n</div>\n<div class=\"section section-2 \" id=\"29004751_WritingUnitTestswithDrillbit-Assertions\">\n<h2 class=\"heading \"><span>Assertions</span></h2>\n<p>\nAll assertions are executed on the return value of the <tt class=\" \">valueOf</tt> method. They all start with the word <tt class=\" \">should</tt>:    </p>\n<div class=\"tablewrap\">\n<table class=\"confluenceTable\">\n<thead class=\" \"></thead><tfoot class=\" \"></tfoot><tbody class=\" \"> <tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldBe(other)    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue should be equal (==) to other    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldNotBe(other)    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue should not be equal (!=) to other    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldBeExactly(other)    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue should be exactly equal (===) to other    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldNotBeExactly(other)    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue should not be exactly equal (!==) to other    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldBeGreaterThan(number)    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue must be greater than number    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldBeGreaterThanEqual(number)    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue must be greater than or equal to number    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldBeLessThan(number)    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue must be less than number    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldBeLessThanEqual(number)    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue must be less than or equal to number    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldBeTrue()    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue must be true (boolean)    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldBeFalse()    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue must be false (boolean)    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldBeNull()    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue must be null    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldNotBeNull()    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue must not be null    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldBeUndefined()    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue must be undefined    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldNotBeUndefined()    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue must not be undefined    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldBeFunction()    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue must be a function    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldBeObject()    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue must be an object    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldBeArray()    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue must be an array    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldBeString()    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue must be a string    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldBeNumber()    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue must be a number    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldBeBoolean()    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue must be a boolean    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldContain(object)    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue must contain object (indexOf(object) != -1)    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldBeOneOf(array)    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue must be found in array    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldMatchArray(array)    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue must be an array and all of it's values must equal (==) array's values    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldThrowException(function)    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nif the value is a function, it will be executed, and it must throw an exception. otherwise, the test fails.    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldNotThrowException(function)    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nif the value is a function, it will be executed, and it must not throw an exception. otherwise, the test fails.    </p>\n</td>\n</tr>\n<tr>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nshouldBeZero()    </p>\n</td>\n<td class=\"confluenceTd\" rowspan=\"1\" colspan=\"1\">\n<p>\nvalue must be 0 (number)    </p>\n</td>\n</tr>\n</tbody> </table>\n</div>\n<p>\nExamples:    </p>\n<div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"confbox programlisting scroll-unprocessed\">\n<div class=\"defaultnew syntaxhighlighter\">\n<div class=\"line\"><code class=\"plain\">valueOf(</code><code class=\"value\">1</code><code class=\"plain\">+</code><code class=\"value\">1</code><code class=\"plain\">).shouldBe(</code><code class=\"value\">2</code><code class=\"plain\">);</code></div>\n<div class=\"line\"><code class=\"plain\">valueOf(</code><code class=\"value\">1</code><code class=\"plain\">*</code><code class=\"value\">3</code><code class=\"plain\">).shouldNotBe(</code><code class=\"value\">4</code><code class=\"plain\">);</code></div>\n<div class=\"line\"><code class=\"plain\">valueOf(</code><code class=\"value\">2</code><code class=\"plain\">).shouldBeGreaterThan(</code><code class=\"value\">1</code><code class=\"plain\">);</code></div>\n<div class=\"line\"><code class=\"plain\">valueOf(Ti.App).shouldBeObject();</code></div>\n<div class=\"line\"><code class=\"plain\">valueOf(userAgent).shouldContain(</code><code class=\"string\">'Titanium/'</code><code class=\"plain\">);</code></div>\n<div class=\"line\"><code class=\"plain\">valueOf(</code><code class=\"string\">'a'</code><code class=\"plain\">).shouldBeOneOf([</code><code class=\"string\">'a'</code><code class=\"plain\">,</code><code class=\"string\">'b'</code><code class=\"plain\">,</code><code class=\"string\">'c'</code><code class=\"plain\">]);</code></div>\n<div class=\"line\"><code class=\"plain\">valueOf([</code><code class=\"value\">1</code><code class=\"plain\">, </code><code class=\"value\">2</code><code class=\"plain\">, </code><code class=\"value\">3</code><code class=\"plain\">]).shouldMatchArray([</code><code class=\"value\">1</code><code class=\"plain\">, </code><code class=\"value\">2</code><code class=\"plain\">, </code><code class=\"value\">3</code><code class=\"plain\">]);</code></div>\n<div class=\"line\"><code class=\"plain\">valueOf(function() {</code></div>\n<div class=\"line\"><code class=\"plain\"> </code><code class=\"keyword\">throw</code><code class=\"plain\"> </code><code class=\"keyword\">new</code><code class=\"plain\"> Exception(</code><code class=\"string\">\"error\"</code><code class=\"plain\">);</code></div>\n<div class=\"line\"><code class=\"plain\">}).shouldThrowException();</code></div>\n</div>\n</div> </div>\n<div class=\"section section-2 \" id=\"29004751_WritingUnitTestswithDrillbit-AsynchronousTests\">\n<h2 class=\"heading \"><span>Asynchronous Tests</span></h2>\n<p>\nYou can make a test asynchronous by appending <tt class=\" \">_as_async</tt> to the end of the function name. Asynchronous tests receive one argument: the callback object.    </p>\n<p>\nThe callback object has two functions:    </p>\n<ul class=\" \"><li class=\" \"> <p>\n<tt class=\" \">passed()</tt> The asynchronous test should call this when the test passes.    </p>\n</li><li class=\" \"> <p>\n<tt class=\" \">failed(error)</tt> The asynchronous test should call this when the test fails, and pass in an exception or an error message    </p>\n</li></ul> <p>\nWhen asserting using the <tt class=\" \">should</tt> functions, if an assertion fails, an exception is thrown by Drillbit. In a normal test, this exception is automatically caught and handled by Drillbit, but in an asynchronous test, you will need to surround assertions with <tt class=\" \">try</tt> and <tt class=\" \">catch</tt>, and call <tt class=\" \">callback.failed(exception)</tt>.    </p>\n<div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"confbox programlisting scroll-unprocessed\">\n<div class=\"title\">An example using Asynchronous XHR and a timeout fallback</div>\n<div class=\"defaultnew syntaxhighlighter\">\n<div class=\"line\"><code class=\"plain\">describe(</code><code class=\"string\">\"test\"</code><code class=\"plain\">, {</code></div>\n<div class=\"line\"><code class=\"plain\">  test_as_async: function(callback) {</code></div>\n<div class=\"line\"><code class=\"plain\">    var xhr = Ti.Network.createHTTPClient();</code></div>\n<div class=\"line\"><code class=\"plain\">    var timer = </code><code class=\"value\">0</code><code class=\"plain\">;</code></div>\n<div class=\"line\"><code class=\"plain\">    xhr.onload = function() {</code></div>\n<div class=\"line\"><code class=\"plain\">      clearTimeout(timer);</code></div>\n<div class=\"line\"><code class=\"plain\"> </code><code class=\"keyword\">try</code><code class=\"plain\"> {</code></div>\n<div class=\"line\"><code class=\"plain\">        valueOf(</code><code class=\"keyword\">this</code><code class=\"plain\">.responseText.length).shouldBeGreaterThan(</code><code class=\"value\">0</code><code class=\"plain\">);</code></div>\n<div class=\"line\"><code class=\"plain\">        callback.passed();</code></div>\n<div class=\"line\"><code class=\"plain\">      } </code><code class=\"keyword\">catch</code><code class=\"plain\"> (e) {</code></div>\n<div class=\"line\"><code class=\"plain\">        callback.failed(e);</code></div>\n<div class=\"line\"><code class=\"plain\">      }</code></div>\n<div class=\"line\"><code class=\"plain\">    };</code></div>\n<div class=\"line\"><code class=\"plain\">    xhr.onerror = function(e) {</code></div>\n<div class=\"line\"><code class=\"plain\">      clearTimeout(timer);</code></div>\n<div class=\"line\"><code class=\"plain\">      callback.failed(e.error);</code></div>\n<div class=\"line\"><code class=\"plain\">    };</code></div>\n<div class=\"line\"><code class=\"plain\">    xhr.open(</code><code class=\"string\">'GET'</code><code class=\"plain\">, </code><code class=\"string\">'http://www.test.com'</code><code class=\"plain\">);</code></div>\n<div class=\"line\"><code class=\"plain\">    xhr.send();</code></div>\n<div class=\"line\"><code class=\"plain\"> </code><code class=\"comments\">// Wait 10s for response</code></div>\n<div class=\"line\"><code class=\"plain\">    timer = setTimeout(function() {</code></div>\n<div class=\"line\"><code class=\"plain\">      callback.failed(</code><code class=\"string\">\"Timed out waiting for HTTP response\"</code><code class=\"plain\">);</code></div>\n<div class=\"line\"><code class=\"plain\">    }, </code><code class=\"value\">10000</code><code class=\"plain\">);</code></div>\n<div class=\"line\"><code class=\"plain\">  }</code></div>\n<div class=\"line\"><code class=\"plain\">});</code></div>\n</div>\n</div> <p>\nDrillbit also provides convenience functions for asynchronous tests:    </p>\n<p>\n<tt class=\" \">asyncTest(args)</tt>: Creates a function suitable for use as an asynchronous test    </p>\n<ul class=\" \"><li class=\" \"> <p>\n<tt class=\" \">args</tt> Either a function that starts the asynchronous task or an object with named arguments:    </p>\n<ul class=\" \"><li class=\" \"> <p>\n<tt class=\" \">args.start</tt> A function that starts the asynchronous task (required). The return value of this function will be passed to <tt class=\" \">onTimeout</tt>, if it is specified.    </p>\n</li><li class=\" \"> <p>\n<tt class=\" \">args.timeout</tt> A timeout in milliseconds. After the timeout is reached, if <tt class=\" \">args.onTimeout</tt> is defined, it is called with a try/catch wrapper. Otherwise, the test will fail with a timeout error message. (optional)    </p>\n</li><li class=\" \"> <p>\n<tt class=\" \">args.onTimeout</tt> : A function that is called after <tt class=\" \">args.timeout</tt> is reached. The return value of the <tt class=\" \">start</tt> function is passed as a parameter (optional)    </p>\n</li><li class=\" \"> <p>\n<tt class=\" \">args.timeoutError</tt> : A custom error to report after <tt class=\" \">args.timeout</tt> is reached (optional)    </p>\n</li></ul></li></ul> <p>\n<tt class=\" \">this.async(function)</tt>: Returns a function wrapper that surrounds `function` in a try/catch and calls callback.passed if it is successful, or callback.failed if an exception is caught. (only available within an `asyncTest` object)    </p>\n<ul class=\" \"><li class=\" \"> <p>\n<tt class=\" \">function</tt> The function with Drillbit assertions    </p>\n</li></ul> <p>\nHere's an example that does the same as above, but uses the convenience APIs to simplify it:    </p>\n<div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"confbox programlisting scroll-unprocessed\">\n<div class=\"defaultnew syntaxhighlighter\">\n<div class=\"line\"><code class=\"plain\">describe(</code><code class=\"string\">\"test\"</code><code class=\"plain\">, {</code></div>\n<div class=\"line\"><code class=\"plain\">  test: asyncTest({</code></div>\n<div class=\"line\"><code class=\"plain\">    start: function(callback) {</code></div>\n<div class=\"line\"><code class=\"plain\">      var xhr = Ti.Network.createHTTPClient();</code></div>\n<div class=\"line\"><code class=\"plain\">      xhr.onload = </code><code class=\"keyword\">this</code><code class=\"plain\">.async(function() {</code></div>\n<div class=\"line\"><code class=\"plain\">        valueOf(</code><code class=\"keyword\">this</code><code class=\"plain\">.responseText.length).shouldBeGreaterThan(</code><code class=\"value\">0</code><code class=\"plain\">);</code></div>\n<div class=\"line\"><code class=\"plain\">      });</code></div>\n<div class=\"line\"><code class=\"plain\">      xhr.onerror = </code><code class=\"keyword\">this</code><code class=\"plain\">.async(function(e) {</code></div>\n<div class=\"line\"><code class=\"plain\"> </code><code class=\"keyword\">throw</code><code class=\"plain\"> e.error;</code></div>\n<div class=\"line\"><code class=\"plain\">      });</code></div>\n<div class=\"line\"><code class=\"plain\">      xhr.open(</code><code class=\"string\">'GET'</code><code class=\"plain\">, </code><code class=\"string\">'http://www.test.com'</code><code class=\"plain\">);</code></div>\n<div class=\"line\"><code class=\"plain\">      xhr.send();</code></div>\n<div class=\"line\"><code class=\"plain\">    },</code></div>\n<div class=\"line\"><code class=\"plain\">    timeout: </code><code class=\"value\">10000</code><code class=\"plain\">,</code></div>\n<div class=\"line\"><code class=\"plain\">    timeoutError: </code><code class=\"string\">\"Timed out waiting for HTTP response\"</code></div>\n<div class=\"line\"><code class=\"plain\">  })</code></div>\n<div class=\"line\"><code class=\"plain\">});</code></div>\n</div>\n</div> </div>\n<div class=\"section section-2 \" id=\"29004751_WritingUnitTestswithDrillbit-RunningDrillbit\">\n<h2 class=\"heading \"><span>Running Drillbit</span></h2>\n<p>\nBefore running Drillbit, you'll need to install one of the newest Titanium Desktop 1.2 RCs, links stored here for posterity:    </p>\n<p>\n<strong class=\" \">1.2 RC4</strong> </p>\n<ul class=\" \"><li class=\" \"> <p>\n<a class=\"external-link external-link\" href=\"http://builds.appcelerator.com.s3.amazonaws.com/RC/desktopsdk-1.2.0.RC4-osx.zip\" target=\"_blank\">Mac OSX</a> </p>\n</li><li class=\" \"> <p>\n<a class=\"external-link external-link\" href=\"http://builds.appcelerator.com.s3.amazonaws.com/RC/desktopsdk-1.2.0.RC4-win32.zip\" target=\"_blank\">Windows</a> </p>\n</li><li class=\" \"> <p>\n<a class=\"external-link external-link\" href=\"http://builds.appcelerator.com.s3.amazonaws.com/RC/desktopsdk-1.2.0.RC4-linux-i386.zip\" target=\"_blank\">Linux 32-bit</a> </p>\n</li><li class=\" \"> <p>\n<a class=\"external-link external-link\" href=\"http://builds.appcelerator.com.s3.amazonaws.com/RC/desktopsdk-1.2.0.RC3-linux-x86_64.zip\" target=\"_blank\">Linux 64-bit</a> </p>\n</li></ul> <p>\nThe drillbit script lives under the Titanium Mobile repository at <tt class=\" \">drillbit/drillbit.py</tt>. The script expects the MobileSDK zip to be built using <tt class=\" \">scons</tt> before it is run. The zip is extracted into <tt class=\" \">dist/mobilesdk</tt> and all tests are built from there.    </p>\n<p>\n<tt class=\" \">drillbit/drillbit.py</tt> can be run without arguments, but there are extra arguments that provide extended functionality and customization    </p>\n<div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"confbox programlisting scroll-unprocessed\">\n<div class=\"title\">Drillbit Usage</div>\n<div class=\"defaultnew syntaxhighlighter\">\n<div class=\"line\"><code class=\"plain\">./drillbit/drillbit.py [--platforms=PLATFORMS] [--tests-dir=DIR] [--results-dir=DIR] [--tests=TESTS] [platform specific args..]</code></div>\n<div class=\"line\"><code class=\"plain\">  Common Arguments</code></div>\n<div class=\"line\"><code class=\"plain\">  --platforms=PLATFORMS\t\t\tA list of platforms to run Drillbit </code><code class=\"keyword\">for</code><code class=\"plain\"> (</code><code class=\"keyword\">default</code><code class=\"plain\">: android,iphone)</code></div>\n<div class=\"line\"><code class=\"plain\">  --tests-dir=DIR\t\t\t\t\tAdditional tests are loaded from DIR</code></div>\n<div class=\"line\"><code class=\"plain\">  --results-dir=DIR\t\t\t\tGenerates JSON and HTML results in DIR</code></div>\n<div class=\"line\"><code class=\"plain\">  --tests=TESTS\t\t\t\t\tSpecify which test suites to enable by </code><code class=\"keyword\">default</code><code class=\"plain\"> (separated by comma)</code></div>\n<div class=\"line\"><code class=\"plain\">  UI Specific arguments:</code></div>\n<div class=\"line\"><code class=\"plain\">  --autorun\t\t\t\t\t\tStart running tests as soon as Drillibit starts</code></div>\n<div class=\"line\"><code class=\"plain\">  --autoclose\t\t\t\t\t\tClose Drillbit as soon as all tests are finished running</code></div>\n<div class=\"line\"><code class=\"plain\">  --web-console\t\t\t\t\tLaunch Drillbit with the Web / Javascript Console showing (</code><code class=\"keyword\">for</code><code class=\"plain\"> debugging Drillbit itself)</code></div>\n<div class=\"line\"><code class=\"plain\">  iPhone Specific Arguments</code></div>\n<div class=\"line\"><code class=\"plain\">  --iphone-version=DIR\t\t\tThe iPhone SDK version to build against (</code><code class=\"keyword\">default</code><code class=\"plain\">: </code><code class=\"value\">4.0</code><code class=\"plain\">)</code></div>\n<div class=\"line\"><code class=\"plain\">  Android Specific Arguments</code></div>\n<div class=\"line\"><code class=\"plain\">  --android-sdk=DIR\t\t\t\tAndroid SDK is loaded from DIR</code></div>\n<div class=\"line\"><code class=\"plain\">  --android-version=VERSION\t\tThe Android Platform version to build against (</code><code class=\"keyword\">default</code><code class=\"plain\">: </code><code class=\"value\">4</code><code class=\"plain\">)</code></div>\n<div class=\"line\"><code class=\"plain\">  --android-force-build\t\t\tWhen passed, the test harness is forcefully built on initial deploy</code></div>\n<div class=\"line\"><code class=\"plain\">  --android-device=DEVICE\t\t\tThe device argument to pass to ADB. (</code><code class=\"keyword\">default</code><code class=\"plain\">: -e)</code></div>\n</div>\n</div> <p>\nFor example, to only run the <tt class=\" \">network.httpclient</tt> test suite for Android:    </p>\n<div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"confbox programlisting scroll-unprocessed\">\n<div class=\"defaultnew syntaxhighlighter\">\n<div class=\"line\"><code class=\"plain\">./drillbit/drillbit.py --platforms=android --tests=network.httpclient</code></div>\n</div>\n</div> </div>\n</div>\n<div class=\"footer\">\n            Created with <a href=\"http://k15t.com/display/web/Scroll-Wiki-EclipseHelp-Exporter-for-Confluence\" target=\"_blank\">Scroll EclipseHelp Exporter for Confluence</a>.\n        </div>\n</div>\n</body>\n</html>\n","title":"Writing Unit Tests with Drillbit"});