<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Ruble Specification</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta content="Scroll EclipseHelp Exporter" name="generator" />
<link type="text/css" rel="stylesheet" />
<link type="text/css" rel="stylesheet" />
<link type="text/css" rel="stylesheet" media="print" />
</head>
<body>
<div class="container">
<div class="header"></div>
<div id="30083218" class="content"><a id="editButton" href="https://wiki.appcelerator.org/pages/editpage.action?pageId=30083218"><span>Edit</span></a>
<h1>Ruble Specification</h1>
<div class="section section-2 " id="30083218_RubleSpecification-Contents">
<h2 class="heading "><span>Contents</span></h2>
<ul class="toc-indentation "><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-Overview" Ruble_Specification.html#30083218_RubleSpecification-Overview="Ruble_Specification.html#30083218_RubleSpecification-Overview">Overview</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-Bundles" Ruble_Specification.html#30083218_RubleSpecification-Bundles="Ruble_Specification.html#30083218_RubleSpecification-Bundles">Bundles</a> </p>
<ul class="toc-indentation "><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-BundleLoading" Ruble_Specification.html#30083218_RubleSpecification-BundleLoading="Ruble_Specification.html#30083218_RubleSpecification-BundleLoading">Bundle Loading</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-Redefining%2COverriding%2CandExtendingBundles" Ruble_Specification.html#30083218_RubleSpecification-Redefining%2COverriding%2CandExtendingBundles="Ruble_Specification.html#30083218_RubleSpecification-Redefining%2COverriding%2CandExtendingBundles">Redefining, Overriding, and Extending Bundles</a> </p>
<ul class="toc-indentation "><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-AMinimalBundle" Ruble_Specification.html#30083218_RubleSpecification-AMinimalBundle="Ruble_Specification.html#30083218_RubleSpecification-AMinimalBundle">A Minimal Bundle</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-RedefiningaBundle" Ruble_Specification.html#30083218_RubleSpecification-RedefiningaBundle="Ruble_Specification.html#30083218_RubleSpecification-RedefiningaBundle">Redefining a Bundle</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-ExtendingaBundle" Ruble_Specification.html#30083218_RubleSpecification-ExtendingaBundle="Ruble_Specification.html#30083218_RubleSpecification-ExtendingaBundle">Extending a Bundle</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-OverridingaBundleElement" Ruble_Specification.html#30083218_RubleSpecification-OverridingaBundleElement="Ruble_Specification.html#30083218_RubleSpecification-OverridingaBundleElement">Overriding a Bundle Element</a> </p>
</li></ul></li></ul></li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-BundleProperties" Ruble_Specification.html#30083218_RubleSpecification-BundleProperties="Ruble_Specification.html#30083218_RubleSpecification-BundleProperties">Bundle Properties</a> </p>
<ul class="toc-indentation "><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-AssociatingaBundlewithaFile-Type" Ruble_Specification.html#30083218_RubleSpecification-AssociatingaBundlewithaFile-Type="Ruble_Specification.html#30083218_RubleSpecification-AssociatingaBundlewithaFile-Type">Associating a Bundle with a File-Type</a> </p>
</li></ul></li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-Scopes" Ruble_Specification.html#30083218_RubleSpecification-Scopes="Ruble_Specification.html#30083218_RubleSpecification-Scopes">Scopes</a> </p>
<ul class="toc-indentation "><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-ScopeSelectors" Ruble_Specification.html#30083218_RubleSpecification-ScopeSelectors="Ruble_Specification.html#30083218_RubleSpecification-ScopeSelectors">Scope Selectors</a> </p>
<ul class="toc-indentation "><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-Example-SimpleNameSelector" Ruble_Specification.html#30083218_RubleSpecification-Example-SimpleNameSelector="Ruble_Specification.html#30083218_RubleSpecification-Example-SimpleNameSelector">Example - Simple Name Selector</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-Example-DottedNameSelector" Ruble_Specification.html#30083218_RubleSpecification-Example-DottedNameSelector="Ruble_Specification.html#30083218_RubleSpecification-Example-DottedNameSelector">Example - Dotted Name Selector</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-Example-DescendantSelector" Ruble_Specification.html#30083218_RubleSpecification-Example-DescendantSelector="Ruble_Specification.html#30083218_RubleSpecification-Example-DescendantSelector">Example - Descendant Selector</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-Example-UnionSelector" Ruble_Specification.html#30083218_RubleSpecification-Example-UnionSelector="Ruble_Specification.html#30083218_RubleSpecification-Example-UnionSelector">Example - Union Selector</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-Example-UnionSelector2" Ruble_Specification.html#30083218_RubleSpecification-Example-UnionSelector2="Ruble_Specification.html#30083218_RubleSpecification-Example-UnionSelector2">Example - Union Selector 2</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-Example-IntersectionSelector" Ruble_Specification.html#30083218_RubleSpecification-Example-IntersectionSelector="Ruble_Specification.html#30083218_RubleSpecification-Example-IntersectionSelector">Example - Intersection Selector</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-Example-Grouping" Ruble_Specification.html#30083218_RubleSpecification-Example-Grouping="Ruble_Specification.html#30083218_RubleSpecification-Example-Grouping">Example - Grouping</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-Example-NegativeLookahead" Ruble_Specification.html#30083218_RubleSpecification-Example-NegativeLookahead="Ruble_Specification.html#30083218_RubleSpecification-Example-NegativeLookahead">Example - Negative Lookahead</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-PrecedenceLevels" Ruble_Specification.html#30083218_RubleSpecification-PrecedenceLevels="Ruble_Specification.html#30083218_RubleSpecification-PrecedenceLevels">Precedence Levels</a> </p>
</li></ul></li></ul></li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-Commands" Ruble_Specification.html#30083218_RubleSpecification-Commands="Ruble_Specification.html#30083218_RubleSpecification-Commands">Commands</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-Snippets" Ruble_Specification.html#30083218_RubleSpecification-Snippets="Ruble_Specification.html#30083218_RubleSpecification-Snippets">Snippets</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-ConventionsandDefinitions" Ruble_Specification.html#30083218_RubleSpecification-ConventionsandDefinitions="Ruble_Specification.html#30083218_RubleSpecification-ConventionsandDefinitions">Conventions and Definitions</a> </p>
<ul class="toc-indentation "><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-PATH_SPECIFIER" Ruble_Specification.html#30083218_RubleSpecification-PATH_SPECIFIER="Ruble_Specification.html#30083218_RubleSpecification-PATH_SPECIFIER">PATH_SPECIFIER</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-INPUT_SPECIFIER" Ruble_Specification.html#30083218_RubleSpecification-INPUT_SPECIFIER="Ruble_Specification.html#30083218_RubleSpecification-INPUT_SPECIFIER">INPUT_SPECIFIER</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-OUTPUT_SPECIFIER" Ruble_Specification.html#30083218_RubleSpecification-OUTPUT_SPECIFIER="Ruble_Specification.html#30083218_RubleSpecification-OUTPUT_SPECIFIER">OUTPUT_SPECIFIER</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-WORKING_DIRECTORY" Ruble_Specification.html#30083218_RubleSpecification-WORKING_DIRECTORY="Ruble_Specification.html#30083218_RubleSpecification-WORKING_DIRECTORY">WORKING_DIRECTORY</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-PLATFORM_SPECIFIER" Ruble_Specification.html#30083218_RubleSpecification-PLATFORM_SPECIFIER="Ruble_Specification.html#30083218_RubleSpecification-PLATFORM_SPECIFIER">PLATFORM_SPECIFIER</a> </p>
</li></ul></li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-Bundle.rb" Ruble_Specification.html#30083218_RubleSpecification-Bundle.rb="Ruble_Specification.html#30083218_RubleSpecification-Bundle.rb">Bundle.rb</a> </p>
<ul class="toc-indentation "><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-Metadata" Ruble_Specification.html#30083218_RubleSpecification-Metadata="Ruble_Specification.html#30083218_RubleSpecification-Metadata">Metadata</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-Menus" Ruble_Specification.html#30083218_RubleSpecification-Menus="Ruble_Specification.html#30083218_RubleSpecification-Menus">Menus</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-Samplebundle.rbFile" Ruble_Specification.html#30083218_RubleSpecification-Samplebundle.rbFile="Ruble_Specification.html#30083218_RubleSpecification-Samplebundle.rbFile">Sample bundle.rb File</a> </p>
</li></ul></li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-CommandsandSnippets" Ruble_Specification.html#30083218_RubleSpecification-CommandsandSnippets="Ruble_Specification.html#30083218_RubleSpecification-CommandsandSnippets">Commands and Snippets</a> </p>
<ul class="toc-indentation "><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-KeyBindings" Ruble_Specification.html#30083218_RubleSpecification-KeyBindings="Ruble_Specification.html#30083218_RubleSpecification-KeyBindings">Key Bindings</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-InputDefinition" Ruble_Specification.html#30083218_RubleSpecification-InputDefinition="Ruble_Specification.html#30083218_RubleSpecification-InputDefinition">Input Definition</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-OutputDefinition" Ruble_Specification.html#30083218_RubleSpecification-OutputDefinition="Ruble_Specification.html#30083218_RubleSpecification-OutputDefinition">Output Definition</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-InvocationandContext" Ruble_Specification.html#30083218_RubleSpecification-InvocationandContext="Ruble_Specification.html#30083218_RubleSpecification-InvocationandContext">Invocation and Context</a> </p>
<ul class="toc-indentation "><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-ContextDuringCommandInvocation" Ruble_Specification.html#30083218_RubleSpecification-ContextDuringCommandInvocation="Ruble_Specification.html#30083218_RubleSpecification-ContextDuringCommandInvocation">Context During Command Invocation</a> </p>
<ul class="toc-indentation "><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-INVOKE_OPTIONS" Ruble_Specification.html#30083218_RubleSpecification-INVOKE_OPTIONS="Ruble_Specification.html#30083218_RubleSpecification-INVOKE_OPTIONS">INVOKE_OPTIONS</a> </p>
</li></ul></li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-InputDuringCommandInvocation" Ruble_Specification.html#30083218_RubleSpecification-InputDuringCommandInvocation="Ruble_Specification.html#30083218_RubleSpecification-InputDuringCommandInvocation">Input During Command Invocation</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Ruble_Specification-section-30083218_RubleSpecification-OutputDuringCommandInvocation" Ruble_Specification.html#30083218_RubleSpecification-OutputDuringCommandInvocation="Ruble_Specification.html#30083218_RubleSpecification-OutputDuringCommandInvocation">Output During Command Invocation</a> </p>
</li></ul></li></ul></li></ul> </div>
<div class="section section-2 " id="30083218_RubleSpecification-Overview">
<h2 class="heading "><span>Overview</span></h2>
<p>
Ruble (short for RUby BundLE) is a runtime environment that allows for the extensibility of IDEs and text editors using Ruby. The first implementation of Rubles will be in Studio 3, but we're making the specification available now because we want to get feedback from the community and because we want to encourage the developers of other development tools to adopt the specification as well. To further that end, we are making the specification available in an open manner, with no limits on use or distribution of this specification.    </p>
<p>
In addition, we are also making the source available for several working Ruble bundles, some of which are conversions of existing open-sourced TextMate bundles, and others are home-grown versions:    </p>
<ul class=" "><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/bundle-dev.ruble" target="_blank">bundle-dev.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/capistrano.ruble" target="_blank">capistrano.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/css.ruble" target="_blank">css.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/cucumber.ruble" target="_blank">cucumber.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/engineyard.ruble" target="_blank">engineyard.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/github.ruble" target="_blank">github.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/haml.ruble" target="_blank">haml.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/heroku.ruble" target="_blank">heroku.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/html.ruble" target="_blank">html.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/javascript-jquery.ruble" target="_blank">javascript-jquery.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/js.ruble" target="_blank">js.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/json.ruble" target="_blank">json.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/math.ruble" target="_blank">math.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/mercurial.ruble" target="_blank">mercurial.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/php.ruble" target="_blank">php.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/rails.ruble" target="_blank">rails.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/rspec.ruble" target="_blank">rspec.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/ruby.ruble" target="_blank">ruby.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/sass.ruble" target="_blank">sass.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/shell-script.ruble" target="_blank">shell-script.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/source.ruble" target="_blank">source.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/text.ruble" target="_blank">text.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/WebFont.ruble" target="_blank">WebFont.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/wordpress.ruble" target="_blank">wordpress.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/xml.ruble" target="_blank">xml.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/yaml.ruble" target="_blank">yaml.ruble</a> </p>
</li><li class=" "> <p>
<a class="external-link external-link" href="https://github.com/aptana/zen-coding.ruble" target="_blank">zen-coding.ruble</a> </p>
</li></ul> <p>
Please keep in mind that the specification and the bundles themselves are in active development and are very likely to change.    </p>
<p>
Design-level compatibility with TextMate bundles was a priority in the design - we wanted to make it reasonably straightforward to convert an existing TextMate bundle into a Ruble bundle, while still allowing commands and snippets to be more concise and more powerful. At the same time, we wanted Ruble bundles to run on Linux and Windows as well as the Mac, so we had to make some changes to deal with issues like key bindings and OS-specific assumptions.    </p>
<p>
The Ruble runtime includes a <tt class=" ">ruble.rb</tt> file that defines a DSL that can be used to create bundles, commands, and menus. <tt class=" ">ruble.rb</tt> must be included via a <tt class=" ">require</tt> in each file within the Bundle that defines bundles, commands, or snippets.    </p>
</div>
<div class="section section-2 " id="30083218_RubleSpecification-Bundles">
<h2 class="heading "><span>Bundles</span></h2>
<p>
Bundles are the top-level distribution format for Ruble extensions. A bundle directory must contain a <tt class=" ">bundle.rb</tt> at the top level. The <tt class=" ">bundle.rb</tt> file defines the metadata for the bundle and its menu(s). By convention, the name of a bundle directory ends with <tt class=" ">.ruble</tt> suffix but this is not required.    </p>
<p>
In addition to the <tt class=" ">bundle.rb</tt> file, there are four top-level directories within a bundle that are treated specially:    </p>
<div class="tablewrap">
<table class="confluenceTable">
<thead class=" "> <tr>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
File/Dir    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Description    </p>
</td>
</tr>
</thead><tfoot class=" "></tfoot><tbody class=" "> <tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">commands/</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
contains the commands that make up the <tt class=" ">bundle.rb</tt> files within this directory will be loaded at startup, so you should keep it as minimal as possible to keep things fast.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">lib/</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
contains Ruby code that is on the load path when executing commands within your bundle. Put code here you wish to invoke from within your commands, but which you do not necessarily want loaded at startup.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">snippets/</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
contains the snippets that make up the <tt class=" ">bundle.rb</tt> files within this directory will be loaded at startup, so you should keep it as minimal as possible to keep things fast.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">templates/</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
contains projects templates used by the &quot;New Project Wizard&quot; when creating a new project in Studio    </p>
</td>
</tr>
</tbody> </table>
</div>
<p>
By convention, there are several other files and directories found in most bundles:    </p>
<div class="tablewrap">
<table class="confluenceTable">
<thead class=" "> <tr>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
File/Dir    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Description    </p>
</td>
</tr>
</thead><tfoot class=" "></tfoot><tbody class=" "> <tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">README</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
your usual README file (these also work: <tt class=" ">README.md</tt>, <tt class=" ">README.markdown</tt>, <tt class=" ">README.textile</tt>, and/or <tt class=" ">README.txt</tt>)    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">Rakefile</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
your Rakefile, typically used for testing, packaging, and so forth    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">assets/</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
images, icons, and other files used by your bundle    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">test/</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
test code    </p>
</td>
</tr>
</tbody> </table>
</div>
<div class="section section-3 " id="30083218_RubleSpecification-BundleLoading">
<h3 class="heading "><span>Bundle Loading</span></h3>
<p>
In Studio 3, Ruble bundles are loaded from the file system in a hierarchical order. The order, from highest to lowest priority, is:    </p>
<ul class=" "><li class=" "> <p>
Any top-level &quot;bundles&quot; directory in all active projects within the current workspace.    </p>
</li><li class=" "> <p>
The <tt class=" ">$USER_DOCUMENT_DIRECTORY/Aptana Rubles/</tt>, where <tt class=" ">$USER_DOCUMENT_DIRECTORY</tt> is platform dependent.    </p>
</li><li class=" "> <p>
The bundles directory within the Aptana Studio installation    </p>
</li></ul> <p>
When a bundle is defined in multiple places, only the bundle code defined in the highest priority location is used. In this way, you can easily do a <tt class=" ">git clone</tt> (or the equivalent) on a bundle from within your <tt class=" ">$USER_DOCUMENT_DIRECTORY/Aptana Rubles</tt> and it will override the ones built into Studio itself.    </p>
<p>
Other implementations are free to keep bundles in whatever locations on disk they desire, but if an implementation does support multiple locations for bundles, it should also use the priority system for determining which bundles are active.    </p>
</div>
<div class="section section-3 " id="30083218_RubleSpecification-Redefining,Overriding,andExtendingBundles">
<h3 class="heading "><span>Redefining, Overriding, and Extending Bundles</span></h3>
<p>
It is possible for a bundle directory and its members to redefine, to override or to extend another bundle directory's functionality. This is quite handy when you want to add a command or two to the menu of the existing bundle without having to maintain your own clone of a bundle repository.    </p>
<p>
Before we can discuss these mechanisms, we need to get some terminology out of the way. Below is a list of terms you may encounter when talking about bundles and how they are defined.    </p>
<div class="tablewrap">
<table class="confluenceTable">
<thead class=" "> <tr>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Term    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Description    </p>
</td>
</tr>
</thead><tfoot class=" "></tfoot><tbody class=" "> <tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Bundle Directory    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
A directory containing a top-level <tt class=" ">bundle.rb</tt> file and optionally other <tt class=" ">.rb</tt> files defining commands, menus, and snippets as discussed in the <i class=" ">Bundles</i> section.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Bundle Name    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
The name of a bundle derived from its bundle directory name. If the directory name ends with .ruble, the bundle name is the directory name with that suffix removed; otherwise, the bundle name is simply the directory name itself.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Bundle Reference    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
When defining a bundle in a <tt class=" ">bundle.rb</tt> file, it is possible to include a name. This name refers to an existing bundle and is used as a mechanism to extend and override a bundle of equal or lower precedence.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Bundle Elements    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
A generic term for any item contained by a bundle: for example, commands, snippets, and menus.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Bundle Definition    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
A bundle instance created by the bundle method. This is a general term used when discussing bundle instances.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Active Bundle    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
This is the resulting bundle after all precedence and reference rules have been applied.    </p>
</td>
</tr>
</tbody> </table>
</div>
<div class="section section-4 " id="30083218_RubleSpecification-AMinimalBundle">
<h4 class="heading "><span>A Minimal Bundle</span></h4>
<p>
In it's simplest form, a bundle can be defined as follows:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain"># $APPLICATION_DIRECTORY/bundles/FunBundle.ruble/bundle.rb</code></div>
<div class="line"><code class="plain">require </code><code class="string">'ruble'</code></div>
<div class="line"><code class="plain">bundle</code></div>
</div>
</div> <p>
Of course, this bundle is not of much use, but it is important to understand what this minimal example does. We see that the bundle directory is contained within the application bundles directory; therefore, this bundle has the lowest precedence as defined in <i class=" ">Bundle Loading</i>. Interpreting this will become clearer shortly. We also know that since the name of the bundle is derived from its bundle directory, the bundle's name is &quot;FunBundle&quot;.    </p>
</div>
<div class="section section-4 " id="30083218_RubleSpecification-RedefiningaBundle">
<h4 class="heading "><span>Redefining a Bundle</span></h4>
<p>
In this next example, we flesh out our bundle with a little skeleton content as well as define a like-named bundle directory at a higher precedence.    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain"># $APPLICATION_DIRECTORY/bundles/FunBundle.ruble/bundle.rb</code></div>
<div class="line"><code class="plain">require </code><code class="string">'ruble'</code></div>
<div class="line"><code class="plain">bundle </code><code class="keyword">do</code><code class="plain"> |b|</code></div>
<div class="line"><code class="plain">  command </code><code class="string">"A"</code><code class="plain"> { |cmd| ... }</code></div>
<div class="line"><code class="plain">end</code></div>
<div class="line"><code class="plain"># $USER_DOCUMENT_DIRECTORY/bundles/FunBundle.ruble/bundle.rb</code></div>
<div class="line"><code class="plain">require </code><code class="string">'ruble'</code></div>
<div class="line"><code class="plain">bundle </code><code class="keyword">do</code><code class="plain"> |b|</code></div>
<div class="line"><code class="plain">  command </code><code class="string">"B"</code><code class="plain"> { |cmd| ... }</code></div>
<div class="line"><code class="plain">end</code></div>
</div>
</div> <p>
We've added an &quot;A&quot; command to our application bundle. We've also defined a bundle with the same name, but this time within the user bundles directory. The user bundles directory has a higher precedence than the application bundles directory. This means that our active FunBundle bundle will contain the &quot;B&quot; command only.    </p>
<p>
When two bundle directories have the same name, the bundle directory with higher precedence completely obscures the content of the lower precedence bundle directory. This can come in handy, for example, if you need to alter an application bundle. You can simply git clone the bundle into your user bundles directory and make your changes there. Since each bundle directory will have the same name, your user version will hide the default bundle implementation.    </p>
</div>
<div class="section section-4 " id="30083218_RubleSpecification-ExtendingaBundle">
<h4 class="heading "><span>Extending a Bundle</span></h4>
<p>
In another scenario, you may be perfectly happy with the content of the application bundle, but you need to add another command to it.    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain"># $APPLICATION_DIRECTORY/bundles/FunBundle.ruble/bundle.rb</code></div>
<div class="line"><code class="plain">require </code><code class="string">'ruble'</code></div>
<div class="line"><code class="plain">bundle </code><code class="keyword">do</code><code class="plain"> |b|</code></div>
<div class="line"><code class="plain">  command </code><code class="string">"A"</code><code class="plain"> { |cmd| ... }</code></div>
<div class="line"><code class="plain">end</code></div>
<div class="line"><code class="plain"># $USER_DOCUMENT_DIRECTORY/bundles/FunBundleExtension.ruble/bundle.rb</code></div>
<div class="line"><code class="plain">require </code><code class="string">'ruble'</code></div>
<div class="line"><code class="plain">bundle </code><code class="string">"FunBundle"</code><code class="plain"> </code><code class="keyword">do</code><code class="plain"> |b|</code></div>
<div class="line"><code class="plain">  command </code><code class="string">"B"</code><code class="plain"> { |cmd| ... }</code></div>
<div class="line"><code class="plain">end</code></div>
</div>
</div> <p>
This looks almost identical to the previous example; however, it has two very important differences. The first difference you may notice is that the bundle method now takes a string. This string changes this user bundle instance into a bundle reference.    </p>
<p>
A bundle reference applies its content to a bundle definition of equal or lower precedence and the bundle it modifies is located by the bundle method's string argument, or said another way, the bundle it modifies is located by name. Applying these rules, our active &quot;FunBundle&quot; bundle now contains the two commands &quot;A&quot; and &quot;B&quot;. Note that additional bundle references may also augment the &quot;FunBundle&quot; bundle. You are not limited to a single bundle reference.    </p>
<p>
The second difference is that we've changed the bundle directory name to &quot;FunBundleExtension&quot;. The importance of this is a bit tricky to explain. As mentioned earlier, when we use the bundle method without a string argument, the bundle instance's name is derived from the bundle directory name. Bundle's that have names that match their bundle directory's name have special functionality. As seen earlier, that functionality is to completely obscure like-named bundles of lower precedence. If we had not renamed our user bundle's directory, the bundle string argument would have matched the default name of &quot;FunBundle&quot;. That would have made this example behave the same as our <i class=" ">Redefining a Bundle</i> example. You should *<strong class=" ">not</strong>* use bundle references explicitly when defining a bundle from scratch, only when referring to other bundles within your own bundle.    </p>
</div>
<div class="section section-4 " id="30083218_RubleSpecification-OverridingaBundleElement">
<h4 class="heading "><span>Overriding a Bundle Element</span></h4>
<p>
In our last scenario, perhaps you find that you are happy with the content of the application &quot;FunBundle&quot; bundle, but you want to change the behavior of one command. The following shows how you would go about that.    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain"># $APPLICATION_DIRECTORY/bundles/FunBundle.ruble/bundle.rb</code></div>
<div class="line"><code class="plain">require </code><code class="string">'ruble'</code></div>
<div class="line"><code class="plain">bundle </code><code class="keyword">do</code><code class="plain"> |b|</code></div>
<div class="line"><code class="plain">  command </code><code class="string">"A"</code><code class="plain"> { |cmd| ... }</code></div>
<div class="line"><code class="plain">end</code></div>
<div class="line"><code class="plain"># $USER_DOCUMENT_DIRECTORY/bundles/MyFunBundleExtension.ruble/bundle.rb</code></div>
<div class="line"><code class="plain">require </code><code class="string">'ruble'</code></div>
<div class="line"><code class="plain">bundle </code><code class="string">"FunBundle"</code><code class="plain"> </code><code class="keyword">do</code><code class="plain"> |b|</code></div>
<div class="line"><code class="plain">  command </code><code class="string">"A"</code><code class="plain"> { |cmd| ... }</code></div>
<div class="line"><code class="plain">end</code></div>
</div>
</div> <p>
As you can see, we use the same mechanism we used to extend a bundle; however, this time since we are using the same name of a command that was defined in our target bundle, our active bundle only contains an &quot;A&quot; command and that is the command that is defined in the user bundles directory.    </p>
</div>
</div>
</div>
<div class="section section-2 " id="30083218_RubleSpecification-BundleProperties">
<h2 class="heading "><span>Bundle Properties</span></h2>
<p>
Bundles have the following properties, all of which are optional:    </p>
<div class="tablewrap">
<table class="confluenceTable">
<thead class=" "> <tr>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Element    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Description    </p>
</td>
</tr>
</thead><tfoot class=" "></tfoot><tbody class=" "> <tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">display_name</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
A human-readable name for the command.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">description</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
A longer textual description of the bundle, in Markdown syntax    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">scope</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
The default scope for commands and snippets defined within the bundle. See 'Scopes' below.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">author</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
One or more author names    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">copyright</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Self explanatory.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">license</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Self explanatory.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">repository</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
A URL to the repository or a webpage explaining how to get access    </p>
</td>
</tr>
</tbody> </table>
</div>
<div class="section section-3 " id="30083218_RubleSpecification-AssociatingaBundlewithaFile-Type">
<h3 class="heading "><span>Associating a Bundle with a File-Type</span></h3>
<p>
A bundle can be associated with one or more file types. This makes it possible for a bundle to be created that defines a set of commands and snippets for a file type that doesn't have a built-in editor and parser. A future version of this API will also allow the definition of syntax coloring elements, auto-indent rules, and perhaps even the ability to create full fledged language parsers.    </p>
<div class="tablewrap">
<table class="confluenceTable">
<thead class=" "> <tr>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Method    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Description    </p>
</td>
</tr>
</thead><tfoot class=" "></tfoot><tbody class=" "> <tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">register_file_type(file_type,scope)</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
This is a convenience method that first calls <tt class=" ">associate_file_type</tt> and then registers that <tt class=" ">file_type</tt> to a particular scope by calling <tt class=" ">associate_scope</tt> </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">associate_file_type(file_type)</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Given a filename pattern, we register files that match to our generic text editor (uses our theme and scripting). <tt class=" ">file_type</tt> must be either an exact filename to match, or a <tt class=" ">*.ext</tt> extension to associate with.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">associate_scope(file_type,scope)</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Registers a top-level scope to report back for any file whose name matches the passed in pattern. Understands * wildcard. Typical values for first arg: <tt class=" ">.yml</tt><strong class=" ">, </strong><tt class=" ">_spec.rb</tt>, <tt class=" ">Rakefile</tt>. <tt class=" ">scope</tt> is a string our a symbol. Underscores are converted to spaces (so <tt class=" ">'source.yaml'</tt> and <tt class=" ">:source_yaml</tt> are equivalent)    </p>
</td>
</tr>
</tbody> </table>
</div>
</div>
</div>
<div class="section section-2 " id="30083218_RubleSpecification-Scopes">
<h2 class="heading "><span>Scopes</span></h2>
<p>
A scope specifies a context within the IDE. For example, when editing a document, the current cursor position within that document has a context associated with it. These scopes are supplied by the IDE and may be queried using the Shift-Control-P key command.    </p>
<p>
Our bundle runtime contains an implementation of scopes that is intended to be <a class="external-link external-link" href="http://manual.macromates.com/en/scope_selectors" target="_blank">compatible with TextMate's</a>.    </p>
<div class="section section-3 " id="30083218_RubleSpecification-ScopeSelectors">
<h3 class="heading "><span>Scope Selectors</span></h3>
<p>
A scope selector describes a pattern of scopes and is composed of dotted names, descendant operators, basic set operation operators, and a grouping operator. In its simplest form, a scope selector consists of a single name.    </p>
<div class="section section-4 " id="30083218_RubleSpecification-Example-SimpleNameSelector">
<h4 class="heading "><span>Example - Simple Name Selector</span></h4>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">text</code></div>
</div>
</div> <p>
A scope selector needs only to match the prefix of a name to be considered a match. In the above example, the selector will match &quot;text&quot;, &quot;text.html&quot;, &quot;text.html.ruby&quot;; however, it will not match &quot;texts.physics&quot;. A prefix match must end at a dot within the scope or at the end of the scope itself.    </p>
</div>
<div class="section section-4 " id="30083218_RubleSpecification-Example-DottedNameSelector">
<h4 class="heading "><span>Example - Dotted Name Selector</span></h4>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">text.html</code></div>
</div>
</div> <p>
A scope selector name may be extended to create a hierarchy. Each name is delimited by a period without spaces between the names and the periods. The same prefix rule as described in &quot;Simple Name Pattern&quot; applies. For example, in the above snippet, the selector will match &quot;text.html&quot; and &quot;text.html.ruby&quot;.    </p>
</div>
<div class="section section-4 " id="30083218_RubleSpecification-Example-DescendantSelector">
<h4 class="heading "><span>Example - Descendant Selector</span></h4>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">text.html source.ruby</code></div>
</div>
</div> <p>
A scope may be defined as a hierarchy of scopes. In this sense, scope selectors match against that hierarchy much like CSS matches against the HTML DOM. In the above example, the selector will match when the editor's cursor is within Ruby code which is within HTML. The same matching rules described in the simple name pattern apply to each dotted name. For instance, the last example will match &quot;text.html.ruby source.ruby.embedded.html&quot; since &quot;text.html&quot; is a prefix of &quot;text.html.ruby&quot; and likewise &quot;source.ruby&quot; is a prefix of &quot;source.ruby.embedded.html&quot;.    </p>
<p>
It is important to note that a descendant match can occur anywhere within a scope but the order of the selectors must be matched. For example, if we had a pattern like &quot;a b c&quot;, this would match &quot;a b c&quot;, &quot;x a b c&quot;, &quot;a b c y&quot;, &quot;x a b c y&quot;, but not &quot;a b x c&quot;.    </p>
</div>
<div class="section section-4 " id="30083218_RubleSpecification-Example-UnionSelector">
<h4 class="heading "><span>Example - Union Selector</span></h4>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">text.html.ruby, text.html source.ruby</code></div>
</div>
</div> <p>
In this example, our selector defines a list of selectors to be used for matching. The comma serves as an OR operator. Specifically, this selector is saying match &quot;text.html.ruby&quot; OR &quot;text.html source.ruby&quot;. All matching rules described previously apply; however, if an alternation fails, matching will restart using the next alternation. Matching ends when either an alternation returns success or once all alternations have been exhausted.    </p>
</div>
<div class="section section-4 " id="30083218_RubleSpecification-Example-UnionSelector2">
<h4 class="heading "><span>Example - Union Selector 2</span></h4>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">text.html.ruby | text.html source.ruby</code></div>
</div>
</div> <p>
The pipe operator operator behaves exactly the same as the comma operator. The only difference between the two is in their precedence levels, with the pipe operator having lower precedence than the comma operator. This allows alternations to be expressed more naturally for those of you that are comfortable with C-like expressions.    </p>
</div>
<div class="section section-4 " id="30083218_RubleSpecification-Example-IntersectionSelector">
<h4 class="heading "><span>Example - Intersection Selector</span></h4>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">text &amp; source</code></div>
</div>
</div> <p>
The ampersand or intersection operator matches only when the expressions on both sides of the operator are true. For example, the above &quot;text &amp; source&quot; selector will match &quot;text.html source.ruby&quot; since &quot;text&quot; and &quot;ruby&quot; both match according to the name selector rules.    </p>
</div>
<div class="section section-4 " id="30083218_RubleSpecification-Example-Grouping">
<h4 class="heading "><span>Example - Grouping</span></h4>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">source &amp; (js | ruby)</code></div>
</div>
</div> <p>
Parentheses can be used to clarify argument of a selector or to group and override operator precedence levels. For example, in the above selector, the parentheses are used to group &quot;js&quot; and &quot;ruby&quot; as part of the intersection with &quot;source&quot;. If the parentheses were removed, the effective precedence would be equivalent to (source &amp; js) | (ruby).    </p>
</div>
<div class="section section-4 " id="30083218_RubleSpecification-Example-NegativeLookahead">
<h4 class="heading "><span>Example - Negative Lookahead</span></h4>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">text.html - source.ruby</code></div>
</div>
</div> <p>
Sometimes you want to match a scope unless it is being used within a child scope. For instance, in the above selector, the negative lookahead operator, '-', is being used to select all &quot;text.html&quot; scopes that do not have a matching scope of &quot;source.ruby&quot; anywhere after it. If we had selector &quot;a b - c&quot;, this would match &quot;a b&quot;, &quot;a b y&quot;, &quot;x a b&quot;, &quot;x a b y&quot;, but not &quot;a b c&quot;, &quot;x a b c&quot;, &quot;x a b c y&quot;, nor &quot;a b x y c&quot;. Notice in the last example that the lookahead extends to the end of the scope being matched and not just the next segment as with the descendant selector.    </p>
</div>
<div class="section section-4 " id="30083218_RubleSpecification-PrecedenceLevels">
<h4 class="heading "><span>Precedence Levels</span></h4>
<p>
The following table lists all of the selector operators, by precedence level, highest precedence first. The higher the precedence, the more tightly the operator binds its operands.    </p>
<div class="tablewrap">
<table class="confluenceTable">
<thead class=" "> <tr>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Operator    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Name(s)    </p>
</td>
</tr>
</thead><tfoot class=" "></tfoot><tbody class=" "> <tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
()    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Parentheses, Group    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
&amp;    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Ampersand, Intersection    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
&lt;space&gt;    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Descendant    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
-    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Negative Lookahead, Asymmetric Difference    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
,    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Comma, Or, Union    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
|    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Pipe, Or, Union    </p>
</td>
</tr>
</tbody> </table>
</div>
</div>
</div>
</div>
<div class="section section-2 " id="30083218_RubleSpecification-Commands">
<h2 class="heading "><span>Commands</span></h2>
<p>
Commands are the fundamental building blocks of Bundles. A command has the following properties:    </p>
<div class="tablewrap">
<table class="confluenceTable">
<thead class=" "> <tr>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Element    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Required?    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Description    </p>
</td>
</tr>
</thead><tfoot class=" "></tfoot><tbody class=" "> <tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">name</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Yes    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
A human-readable name for the command. Must be unique within the bundle.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">invoke</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Yes    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
The code to be executed. If specified as a string, it is executed as a shell script. If passed a block, it is invoked as a block when the command is executed.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">scope</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
</p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
The scope in which the command can be executed. If no scope is specified, the command is assumed to be active in all scopes.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">input</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
</p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
The input to the command. See the <i class=" ">Input Definition</i> section below.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">output</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
</p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
The output of the command. See the <i class=" ">Output Definition</i> section below.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">working_directory</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
</p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
The working directory to use when invoking the command as a shell script. See the <i class=" ">Working Directory Definition</i> section below.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">key_binding</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
</p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
The keyboard binding for the command. It is also possible to define platform-specific key bindings, as described in the <i class=" ">Key Bindings</i> section below.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">trigger</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
</p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
A tab trigger that will invoke the command if typed into an editor window and then the &lt;TAB&gt; key is pressed. It is possible to define both a trigger and a key_binding for a single command.    </p>
</td>
</tr>
</tbody> </table>
</div>
<p>
Example command:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">command </code><code class="string">"Documentation for Word"</code><code class="plain"> </code><code class="keyword">do</code><code class="plain"> |cmd|</code></div>
<div class="line"><code class="plain">  cmd.scope = </code><code class="string">"source.ruby.rails, text.html.ruby, text.haml"</code></div>
<div class="line"><code class="plain">  cmd.key_binding = </code><code class="string">"Control+H"</code></div>
<div class="line"><code class="plain">  cmd.key_binding.mac = </code><code class="string">"Command+H"</code></div>
<div class="line"><code class="plain">  cmd.input = [ :selection, :word ]</code></div>
<div class="line"><code class="plain">  cmd.output = :show_as_html</code></div>
<div class="line"><code class="plain">  cmd.invoke </code><code class="keyword">do</code><code class="plain"> |context|</code></div>
<div class="line"><code class="plain">    url = </code><code class="string">"http://apidock.com/rails/search/quick?query="</code><code class="plain"> + CGI.escape(context.input)</code></div>
<div class="line"><code class="plain">    context.browser.open url, :new_window =&gt; </code><code class="keyword">true</code></div>
<div class="line"><code class="plain">  end</code></div>
<div class="line"><code class="plain">end</code></div>
</div>
</div> </div>
<div class="section section-2 " id="30083218_RubleSpecification-Snippets">
<h2 class="heading "><span>Snippets</span></h2>
<p>
Snippets are a specialized form of commands, designed to make it easier to specify the behavior of tab triggers. Snippets have a name, a scope, a trigger, and an expansion. You can think of these two declarations as being equivalent:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">snippet </code><code class="string">"My Snippet"</code><code class="plain"> </code><code class="keyword">do</code><code class="plain"> |snip|</code></div>
<div class="line"><code class="plain">  snip.trigger = </code><code class="string">"foo"</code></div>
<div class="line"><code class="plain">  snip.expansion = </code><code class="string">"my_super_snippet"</code></div>
<div class="line"><code class="plain">end</code></div>
<div class="line"><code class="plain">command </code><code class="string">"My Snippet"</code><code class="plain"> </code><code class="keyword">do</code><code class="plain"> |cmd|</code></div>
<div class="line"><code class="plain">  cmd.trigger = </code><code class="string">"foo"</code></div>
<div class="line"><code class="plain">  cmd.expansion = </code><code class="string">"my_super_snippet"</code></div>
<div class="line"><code class="plain">  cmd.input = :none</code></div>
<div class="line"><code class="plain">  cmd.output = :insert_as_snippet</code></div>
<div class="line"><code class="plain">  cmd.invoke </code><code class="keyword">do</code><code class="plain"> |context|</code></div>
<div class="line"><code class="plain">    context.output = cmd.expansion</code></div>
<div class="line"><code class="plain">  end</code></div>
<div class="line"><code class="plain">end</code></div>
</div>
</div> <p>
Here are the properties specific to snippets. Note that the <tt class=" ">trigger</tt> is required, unlike the case for commands.    </p>
<div class="tablewrap">
<table class="confluenceTable">
<thead class=" "> <tr>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Element    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Required?    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Description    </p>
</td>
</tr>
</thead><tfoot class=" "></tfoot><tbody class=" "> <tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">name</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Yes    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
A human-readable name for the command. Must be unique within the bundle.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">scope</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
</p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
The scope in which the command can be executed. If no scope is specified, the command is assumed to be active in all scopes.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">trigger</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Yes    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
A tab trigger that will invoke the command if typed into an editor window and then the &lt;TAB&gt; key is pressed. It is possible to define both a trigger and a key_binding for a single command.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">expansion</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Yes    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
The snippet text that will be substituted for the command trigger.    </p>
</td>
</tr>
</tbody> </table>
</div>
<p>
FORTHCOMING: the syntax for the expansion string (which roughly follows TextMate, but doesn't support nesting at present)    </p>
</div>
<div class="section section-2 " id="30083218_RubleSpecification-ConventionsandDefinitions">
<h2 class="heading "><span>Conventions and Definitions</span></h2>
<p>
Several properties defined in this document can have a variety of different values, and these types of values are defined by names in ALL_CAPS. Specifiers that are used in multiple places within this document are defined in this section.    </p>
<div class="section section-3 " id="30083218_RubleSpecification-PATH_SPECIFIER">
<h3 class="heading "><span>PATH_SPECIFIER</span></h3>
<p>
Paths can be specified in many places in the API. Whenever you see the term PATH_SPECIFIER, the path can be specified as one of the following:    </p>
<ul class=" "><li class=" "> <p>
a string specifying either a full path or a relative path. If only a relative path is provided, it will be be interpreted relative to the bundle directory if it is evaluated at <i class=" ">command definition</i> time, and relative to the command's working directory if it is evaluated at <i class=" ">command invocation</i> time (the latter is more common).    </p>
</li><li class=" "> <p>
an object that will return a path string as defined directly above when its <tt class=" ">to_s</tt> method is called (e.g. <tt class=" ">File</tt>)    </p>
</li><li class=" "> <p>
a Ruby <tt class=" ">symbol</tt> with special meaning. For example, <tt class=" ">:current_project</tt> might refer to the currently loaded project (NOT YET IMPLEMENTED)    </p>
</li></ul> </div>
<div class="section section-3 " id="30083218_RubleSpecification-INPUT_SPECIFIER">
<h3 class="heading "><span>INPUT_SPECIFIER</span></h3>
<p>
The possible input specifiers are:    </p>
<div class="tablewrap">
<table class="confluenceTable">
<thead class=" "> <tr>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Specifier    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Description    </p>
</td>
</tr>
</thead><tfoot class=" "></tfoot><tbody class=" "> <tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:selection</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
selected text in the editor    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:left_character</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
the character to the immediate left of the caret    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:right_character</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
the character to the immediate right of the caret    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:word</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
word surrounding the current caret    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:line</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
the line containing the caret    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:document</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
the entire current document    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:clipboard</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
the contents of the clipboard    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:scope</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
(NOT YET IMPLEMENTED) As in TextMate: search backwards and forwards for the first character which is not matched by the scope selector of the command and use those as boundaries for the input.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:input_from_console</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
take input from a shell window? How do we specify which console?    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:none</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
no input is needed by this command. When encountered in the <strong class=" ">multiple symbol specifier</strong> case, this symbol always terminates fallback evaluation    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:selected_lines</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
I'm not sure what this does or how it differs from :selection!!!    </p>
</td>
</tr>
</tbody> </table>
</div>
</div>
<div class="section section-3 " id="30083218_RubleSpecification-OUTPUT_SPECIFIER">
<h3 class="heading "><span>OUTPUT_SPECIFIER</span></h3>
<p>
The possible output specifiers are:    </p>
<div class="tablewrap">
<table class="confluenceTable">
<thead class=" "> <tr>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Specifier    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Description    </p>
</td>
</tr>
</thead><tfoot class=" "></tfoot><tbody class=" "> <tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:insert_as_text</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
insert text at the caret position. If there is a selection, the text is inserted immediately following the selection and the selection is lost.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:insert_as_snippet</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
as with <tt class=" ">:insert_as_text</tt>, but the output is interpreted as snippet expansion text    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:replace_selection</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
replace the currently selected text with the output. If no text is selected, this is equivalent to the <tt class=" ">:insert_as_text</tt> specifier    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:replace_document</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
replace the entire document with the output    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:copy_to_clipboard</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
replace the contents of the clipboard with the output    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:show_as_html</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
open an html browser window and intepret the output as html    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:show_as_tooltip</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
show a tooltip containing the output    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:create_new_document</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
create a new editor document containing the output    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:output_to_console</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
display the output in a console. HOW DO WE SPECIFY WHICH CONSOLE    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:discard</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
throw any output away    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:replace_selected_lines</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
what does this do? probably unnecessary    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:replace_line</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
replace the line around the caret. probably unnecessary    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:replace_word</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
replace the word around the caret. probably unnecessary    </p>
</td>
</tr>
</tbody> </table>
</div>
</div>
<div class="section section-3 " id="30083218_RubleSpecification-WORKING_DIRECTORY">
<h3 class="heading "><span>WORKING_DIRECTORY</span></h3>
<p>
The possible working directory specifiers are:    </p>
<div class="tablewrap">
<table class="confluenceTable">
<thead class=" "> <tr>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Specifier    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Description    </p>
</td>
</tr>
</thead><tfoot class=" "></tfoot><tbody class=" "> <tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">'any string'</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
the string is interpreted as an absolute path    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:current_file</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Use the command's parent dir as the working dir. This is the default behavior.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:current_project</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Use the active project in the App Explorer as the working directory.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:current_bundle</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Use the command's owning bundle's directory as the working directory. Typically this is the parent dir of what you'd get with <tt class=" ">:current_file</tt> </p>
</td>
</tr>
</tbody> </table>
</div>
</div>
<div class="section section-3 " id="30083218_RubleSpecification-PLATFORM_SPECIFIER">
<h3 class="heading "><span>PLATFORM_SPECIFIER</span></h3>
<p>
Supported platform identifiers are <tt class=" ">all</tt>, <tt class=" ">mac</tt>, <tt class=" ">windows</tt>, <tt class=" ">linux</tt>, and <tt class=" ">unix</tt>. The <tt class=" ">unix</tt> identifier will match Linux, BSD, Solaris, and most other unix-like OSes (but not Mac OS X). The <tt class=" ">all</tt> specifier is the same as not providing a platform specifier at all.    </p>
</div>
</div>
<div class="section section-2 " id="30083218_RubleSpecification-Bundle.rb">
<h2 class="heading "><span>Bundle.rb</span></h2>
<p>
As discussed in the <i class=" ">Runtime Architecture</i> section above, the <tt class=" ">bundle.rb</tt> file defines the metadata and menus for the bundle. This section specifies these items in more detail.    </p>
<div class="section section-3 " id="30083218_RubleSpecification-Metadata">
<h3 class="heading "><span>Metadata</span></h3>
<p>
Bundles have metadata associated with them. The following properties are pre-defined:    </p>
<div class="tablewrap">
<table class="confluenceTable">
<thead class=" "> <tr>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Property    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Description    </p>
</td>
</tr>
</thead><tfoot class=" "></tfoot><tbody class=" "> <tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">name</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
the user-visible name of the bundle. E.g, &quot;Ruby on Rails&quot;. This name will be shown in menus, error messages, and so forth.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">description</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
a longer, textual description of the bundle and its purpose    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">author</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
the author(s) of the bundle    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">copyright</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
any copyright message associated with the bundle    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">license</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
the name or URL of the license associated with the bundle. E.g. &quot;MIT License&quot; or <a class="external-link external-link" href="http://www.gnu.org/licenses/gpl-3.0.txt" target="_blank">http://www.gnu.org/licenses/gpl-3.0.txt</a> </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">website</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
the website where more information about the bundle can be found    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">repository</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
the public repository url where the canonical version of this bundle lives. E.g. git://github.com/aptana/rails.ruble.git    </p>
</td>
</tr>
</tbody> </table>
</div>
<p>
Additional properties can be accessed, though, simply by referring to them as though they already exist, e.g.:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">bundle.foo = </code><code class="string">"bar"</code></div>
</div>
</div> </div>
<div class="section section-3 " id="30083218_RubleSpecification-Menus">
<h3 class="heading "><span>Menus</span></h3>
<p>
A bundle may define one or more menus to expose its commands and snippets to the user. Most bundles will only define a single menu. RadRails shows these menus in a number of places. First and foremost, it shows up in the main menu underneath the 'Commands' menu. It also shows up in the right-click context menu of editor windows.    </p>
<p>
A menu is a container for commands, sub-menus, and separators. Commands are specified by their names, with all other information coming from the command itself (e.g., its <tt class=" ">key_binding</tt> or <tt class=" ">trigger</tt>). As discussed earlier, these names are scoped to the current bundle.    </p>
<p>
Menus also have a scope, which defines the contexts in which the entire menu is applicable. We interpret the scopes for menus more loosely than we do for commands, erring to show the menu more often than not. And the Commands menu will still show your menu in the &quot;Other&quot; submenu of the Commands menu even if your scope operator doesn't match. Note that while you can define a scope for a sub-menu, but it is currently ignored.    </p>
</div>
<div class="section section-3 " id="30083218_RubleSpecification-Samplebundle.rbFile">
<h3 class="heading "><span>Sample bundle.rb File</span></h3>
<p>
The following is a real but extremely minimal bundle.rb file which defines a 'Rails' menu which in turn contains only a single 'Go To' submenu.    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">require </code><code class="string">'ruble'</code></div>
<div class="line"><code class="plain">bundle </code><code class="keyword">do</code><code class="plain"> |bundle|</code></div>
<div class="line"><code class="plain">  bundle.name = </code><code class="string">"Ruby on Rails"</code></div>
<div class="line"><code class="plain">  bundle.author = </code><code class="string">"Many"</code></div>
<div class="line"><code class="plain">  bundle.repository = </code><code class="string">"git://github.com/aptana/rails.ruble.git"</code></div>
<div class="line"><code class="plain">  bundle.menu </code><code class="string">"Rails"</code><code class="plain"> </code><code class="keyword">do</code><code class="plain"> |rails_menu|</code></div>
<div class="line"><code class="plain">    # </code><code class="keyword">this</code><code class="plain"> menu should be shown when any of the following scopes is active:</code></div>
<div class="line"><code class="plain">    rails_menu.scope = [ </code><code class="string">"source.ruby"</code><code class="plain">, </code><code class="string">"project.rails"</code><code class="plain"> ]</code></div>
<div class="line"><code class="plain">    rails_menu.menu </code><code class="string">"Go To"</code><code class="plain"> </code><code class="keyword">do</code><code class="plain"> |goto_menu|</code></div>
<div class="line"><code class="plain">      goto_menu.command </code><code class="string">"Go to File on Current Line"</code></div>
<div class="line"><code class="plain">      goto_menu.separator</code></div>
<div class="line"><code class="plain">      goto_menu.command </code><code class="string">"Go to Model"</code></div>
<div class="line"><code class="plain">      goto_menu.command </code><code class="string">"Inline Command"</code><code class="plain"> </code><code class="keyword">do</code><code class="plain"> |cmd|</code></div>
<div class="line"><code class="plain">        cmd.invoke </code><code class="keyword">do</code><code class="plain"> |ctx|</code></div>
<div class="line"><code class="plain">          CONSOLE.puts </code><code class="string">"Hello!"</code></div>
<div class="line"><code class="plain">        end</code></div>
<div class="line"><code class="plain">      end</code></div>
<div class="line"><code class="plain">      # etc....</code></div>
<div class="line"><code class="plain">    end</code></div>
<div class="line"><code class="plain">end</code></div>
</div>
</div> </div>
</div>
<div class="section section-2 " id="30083218_RubleSpecification-CommandsandSnippets">
<h2 class="heading "><span>Commands and Snippets</span></h2>
<p>
As discussed in the <i class=" ">Runtime Architecture</i> section above, commands and snippets are the backbone of the bundle runtime. This section lays out the definition and invocation of commands and snippets in more detail.    </p>
<div class="section section-3 " id="30083218_RubleSpecification-KeyBindings">
<h3 class="heading "><span>Key Bindings</span></h3>
<p>
A command can optionally have one or more key bindings associated with it. These key bindings are specified using one of the following forms:    </p>
<p>
If there is only one key binding associated with the command:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">command.key_binding = KEY_SEQUENCE</code></div>
</div>
</div> <p>
Examples:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">command.key_binding = </code><code class="string">"CONTROL+T"</code><code class="plain"> # Single key stroke key binding</code></div>
<div class="line"><code class="plain">command.key_binding = </code><code class="string">"M1+M3+Q C"</code><code class="plain"> # Multiple key stroke key binding</code></div>
</div>
</div> <p>
If there are more than one key bindings associated with the command, an array of key binding sequences can be specified.    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">command.key_binding = [ KEY_SEQUENCE, KEY_SEQUENCE, etc. ]</code></div>
</div>
</div> <p>
Example:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">command.key_binding = [ </code><code class="string">"M1+W"</code><code class="plain">, </code><code class="string">"M1+F4"</code><code class="plain"> ] # Multiple keybindings </code><code class="keyword">for</code><code class="plain"> same command</code></div>
</div>
</div> <p>
The KEY_SEQUENCE syntax follows the Eclipse conventions, since those are more portable than the ones used in TextMate. A KEY_SEQUENCE should consist of one or more key strokes. Key strokes are separated by spaces. A key stroke consists of one or more keys held down at the same time. This should be zero or more modifier keys, and one other key. The keys are separated by the + character. The recognized modifiers keys are ALT or OPTION, COMMAND, CTRL, and SHIFT. In addition M1, M2, M3, M4 modifier keys are also recognized. The &quot;M&quot; modifier keys are a platform-independent way of representing keys, and these are generally preferred. M1 is the COMMAND key on MacOS X, and the CTRL key on most other platforms. M2 is the SHIFT key. M3 is the Option key on MacOS X, and the ALT key on most other platforms. M4 is the CTRL key on MacOS X, and is undefined on other platforms. Since M2+M3+&lt;Letter&gt; (Alt+Shift+&lt;Letter&gt;) is reserved on MacOS X for writing special characters.    </p>
<div class="tablewrap">
<table class="confluenceTable">
<thead class=" "> <tr>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Shortcut    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Platform    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Key    </p>
</td>
</tr>
</thead><tfoot class=" "></tfoot><tbody class=" "> <tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
M1    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
OS X    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
COMMAND    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
M1    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Other Platforms    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
CONTROL (CTRL)    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
M2    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
All Platforms    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
SHIFT    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
M3    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
OS X    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
OPTION    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
M3    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Other Platforms    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
ALT    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
M4    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
OS X    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
CONTROL (CTRL)    </p>
</td>
</tr>
</tbody> </table>
</div>
<p>
The actual key is generally specified simply as the ASCII character, in uppercase. So, for example F or X, are examples of such keys. However, there are some special keys; keys that have no printable ASCII representation. The following is a list of the current special keys:    </p>
<div class="tablewrap">
<table class="confluenceTable">
<thead class=" "> <tr>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Key    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
...    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
...    </p>
</td>
</tr>
</thead><tfoot class=" "></tfoot><tbody class=" "> <tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
ARROW_DOWN    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
F1    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
NUMPAD_0    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
ARROW_LEFT    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
F2    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
NUMPAD_1    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
ARROW_RIGHT    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
F3    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
NUMPAD_2    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
ARROW_UP    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
F4    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
NUMPAD_3    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
BREAK    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
F5    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
NUMPAD_4    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
BS    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
F6    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
NUMPAD_5    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
CAPS_LOCK    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
F7    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
NUMPAD_6    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
CR    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
F8    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
NUMPAD_7    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
DEL    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
F9    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
NUMPAD_8    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
END    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
F10    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
NUMPAD_9    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
ESC    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
F11    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
NUMPAD_ADD    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
HOME    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
F12    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
NUMPAD_DECIMAL    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
INSERT    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
F13    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
NUMPAD_DIVIDE    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
LF    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
F14    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
NUMPAD_ENTER    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
FF    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
F15    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
NUMPAD_EQUAL    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
NUL    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
PRINT_SCREEN    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
NUMPAD_MULTIPLY    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
PAGE_UP    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
PAUSE    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
NUMPAD_SUBTRACT    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
PAGE_DOWN    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
SCROLL_LOCK    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
NUM_LOCK    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
SPACE    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
TAB    </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
VT    </p>
</td>
</tr>
</tbody> </table>
</div>
<p>
Alternate names for some common special keys are also allowed. For example, ESC/ESCAPE, and CR/ENTER/RETURN are synonyms.    </p>
<p>
We strongly recommend against the use of SHIFT or M2 without including another CONTROL_KEY_SPECIFIER, as the results can be unpredictable.    </p>
<p>
It is possible for commands to define specific key bindings for specific platforms. To enable this, the <tt class=" ">key_binding</tt> can be made platform specific. Platform-specific bindings always take<br />precedence over the generic binding regardless of declaration order. See the example below:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">command.key_binding = </code><code class="string">"CONTROL+V"</code></div>
<div class="line"><code class="plain">command.key_binding.mac = </code><code class="string">"COMMAND+V"</code></div>
</div>
</div> <p>
The allowed specifications are defined in the PLATFORM_SPECIFIER section.    </p>
</div>
<div class="section section-3 " id="30083218_RubleSpecification-InputDefinition">
<h3 class="heading "><span>Input Definition</span></h3>
<p>
Commands can take their input from a variety of different sources, or a combination of those sources. This makes it very easy to create commands that can process input from editors without writing a bunch of if/then statements within your command.    </p>
<p>
Inputs can be specified using the <strong class=" ">single input specifier</strong> form:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">command.input = INPUT_SPECIFIER</code></div>
</div>
</div> <p>
or the <strong class=" ">multiple input specifier</strong> form:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">command.input = [ INPUT_SPECIFIER, INPUT_SPECIFIER, etc. ]</code></div>
</div>
</div> <p>
or the <strong class=" ">path specifier</strong> form:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">command.input = PATH_SPECIFIER</code></div>
</div>
</div> <p>
In the <strong class=" ">multiple input specifier</strong> form, each <tt class=" ">INPUT_SPECIFIER</tt> is processed in order until a valid <tt class=" ">INPUT_SPECIFIER</tt> was found. So if, for example, the command specified:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">cmd.input = [ :selection, :word ]</code></div>
</div>
</div> <p>
Then the <tt class=" ">:selection</tt> specifier would be checked to see if it evaluated to a non-empty value. If it did not have such a value, the <tt class=" ">:word</tt> specifier would be checked. If the caret was not within a valid word, then the command would be invoked with a nil input.    </p>
</div>
<div class="section section-3 " id="30083218_RubleSpecification-OutputDefinition">
<h3 class="heading "><span>Output Definition</span></h3>
<p>
As with input, commands may wish to generate output in a number of different ways. In Ruble, output can be specified using the <strong class=" ">single output specifier</strong> form:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">command.output = OUTPUT_SPECIFIER</code></div>
</div>
</div> <p>
or the <strong class=" ">path specifier</strong> form:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">command.output = PATH_SPECIFIER</code></div>
</div>
</div> <p>
As with the input specifier, the <strong class=" ">path specifier</strong> form allows you to define a filename or other stream specifier to write the output to.    </p>
</div>
<div class="section section-3 " id="30083218_RubleSpecification-InvocationandContext">
<h3 class="heading "><span>Invocation and Context</span></h3>
<p>
As described above, ever command must define an <tt class=" ">invoke</tt> property that specifies the actions to perform when the command is run. The action can either be a string, which is run in the user's default shell, or a ruby block, which is executed inline.    </p>
<p>
In addition, you can specify platform specific invoke properties by specifying the platform definitions:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain"># general form, used </code><code class="keyword">if</code><code class="plain"> no platform specific form is provided</code></div>
<div class="line"><code class="plain">command.invoke = </code><code class="string">"ls"</code></div>
<div class="line"><code class="plain">command.invoke.windows = </code><code class="string">"dir /s"</code></div>
<div class="line"><code class="plain">command.invoke.linux </code><code class="keyword">do</code><code class="plain"> |context|</code></div>
<div class="line"><code class="plain"># some ruby stuff</code></div>
<div class="line"><code class="plain">end</code></div>
</div>
</div> <p>
The allowed platforms are defined in the PLATFORM_SPECIFIER section of this document.    </p>
<div class="section section-4 " id="30083218_RubleSpecification-ContextDuringCommandInvocation">
<h4 class="heading "><span>Context During Command Invocation</span></h4>
<p>
When a command's <tt class=" ">invoke</tt> property is set a ruby block, that block is passed a <tt class=" ">context</tt> object as an argument. The context object has the following properties:    </p>
<div class="tablewrap">
<table class="confluenceTable">
<thead class=" "> <tr>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Property    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Description    </p>
</td>
</tr>
</thead><tfoot class=" "></tfoot><tbody class=" "> <tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">input</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
The input to the command as a string. See the <i class=" ">Input During Command Invocation</i> section below.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">invoked_via</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
How the command was invoked. Can be <tt class=" ">:key_binding</tt>, <tt class=" ">:menu</tt>, <tt class=" ">:unknown</tt>, <tt class=" ">:command</tt>, or <tt class=" ">:trigger</tt>.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">command</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
The Command object being executed.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">bundle</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
The Bundle in which the command is defined.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">scope</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
The Scope in which the command was executed.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">project</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
The Project that owns the file currently being edited, or nil. See <i class=" ">Project API</i> for more information.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">editor</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
The currently active Aptana file editor. See <i class=" ">Editor API</i> for more information.    </p>
</td>
</tr>
</tbody> </table>
</div>
<p>
In addition, the context has a few handy-dandy functions for use by commands, as described below:    </p>
<div class="tablewrap">
<table class="confluenceTable">
<thead class=" "> <tr>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Method    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Description    </p>
</td>
</tr>
</thead><tfoot class=" "></tfoot><tbody class=" "> <tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">exit_with_message(message, OUTPUT_SPECIFIER)</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
Short-circuit the execution of the command, using the specified OUTPUT_SPECIFIER    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">invoke(name, INVOKE_OPTIONS)</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
(NOT YET IMPLEMENTED) Invoke another command or snippet by name, and return its context object so that its output and other properties can be extracted.    </p>
</td>
</tr>
</tbody> </table>
</div>
<div class="section section-5 " id="30083218_RubleSpecification-INVOKE_OPTIONS">
<h5 class="heading "><span>INVOKE_OPTIONS</span></h5>
<p>
You can supply additional options to the <tt class=" ">invoke</tt> method via its INVOKE_OPTIONS hash. These options effect the state of the context object passed to the command when it is invoked:    </p>
<div class="tablewrap">
<table class="confluenceTable">
<thead class=" "> <tr>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Key    </p>
</td>
<td class="confluenceTh" rowspan="1" colspan="1">
<p>
Description    </p>
</td>
</tr>
</thead><tfoot class=" "></tfoot><tbody class=" "> <tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:input</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
If specified, the context's <tt class=" ">input</tt> property will be set to this value. This is useful when you want your command to process user input and then have another command further process that input. If it is not defined the INPUT_SPECIFIER in the command's definition will be used as normal.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:output</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
If specified, this OUTPUT_SPECIFIER overrides the one defined by the command.    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:scope</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
The scope specifier to be passed to the command    </p>
</td>
</tr>
<tr>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
<tt class=" ">:bundle</tt> </p>
</td>
<td class="confluenceTd" rowspan="1" colspan="1">
<p>
If specified, look for the command to invoke in the named bundle instead of the current bundle.    </p>
</td>
</tr>
</tbody> </table>
</div>
</div>
</div>
<div class="section section-4 " id="30083218_RubleSpecification-InputDuringCommandInvocation">
<h4 class="heading "><span>Input During Command Invocation</span></h4>
<p>
If a command is defined to invoke a shell script, the command supplies the input text on <tt class=" ">STDIN</tt> and as <a class="external-link external-link" href="http://manual.macromates.com/en/environment_variables.html" target="_blank">environment variables</a>, for compatibility with TextMate.    </p>
<p>
If a command is defined to invoke an inline Ruby block, the input is passed to the block via <tt class=" ">STDIN</tt>. Alternately, the context's <tt class=" ">input</tt> property can be used to access the input a simple string. Note that all environment variables that are defined for shell script commands are also available to command blocks via the ENV hash.    </p>
</div>
<div class="section section-4 " id="30083218_RubleSpecification-OutputDuringCommandInvocation">
<h4 class="heading "><span>Output During Command Invocation</span></h4>
<p>
By default, any output to <tt class=" ">STDOUT</tt> during command invocation is treated as the output of the command. If the command is defined to invoke a ruby inline block, the return value may be used to define the command result. The return value will be converted to a string via to_s. In the event output is written to <tt class=" ">STDOUT</tt> and a non-nil value is returned from the block, the return value will take precedence. Or said another way, if you want to make sure your output to STDOUT serves as your command's result, then be sure to return <tt class=" ">nil</tt> as your command's result.    </p>
<p>
Output written to <tt class=" ">STDERR</tt> during command execution will be displayed in the Console.    </p>
</div>
</div>
</div>
</div>
<div class="footer">
            Created with <a href="http://k15t.com/display/web/Scroll-Wiki-EclipseHelp-Exporter-for-Confluence" target="_blank">Scroll EclipseHelp Exporter for Confluence</a>.
        </div>
</div>
</body>
</html>
