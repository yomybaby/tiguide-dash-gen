<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>iOS Interactive Notifications</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta content="Scroll EclipseHelp Exporter" name="generator" />
<link type="text/css" rel="stylesheet" />
<link type="text/css" rel="stylesheet" />
<link type="text/css" rel="stylesheet" media="print" />
</head>
<body>
<div class="container">
<div class="header"></div>
<div id="40930452" class="content"><a id="editButton" href="https://wiki.appcelerator.org/pages/editpage.action?pageId=40930452"><span>Edit</span></a>
<h1>iOS Interactive Notifications</h1>
<ul class="toc-indentation "><li class=" "> <p>
<a class="document-link " href="#!/guide/iOS_Interactive_Notifications-section-40930452_iOSInteractiveNotifications-Introduction" iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-Introduction="iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-Introduction">Introduction</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/iOS_Interactive_Notifications-section-40930452_iOSInteractiveNotifications-InteractiveNotificationTypes" iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-InteractiveNotificationTypes="iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-InteractiveNotificationTypes">Interactive Notification Types</a> </p>
<ul class="toc-indentation "><li class=" "> <p>
<a class="document-link " href="#!/guide/iOS_Interactive_Notifications-section-40930452_iOSInteractiveNotifications-AlertDialog" iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-AlertDialog="iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-AlertDialog">Alert Dialog</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/iOS_Interactive_Notifications-section-40930452_iOSInteractiveNotifications-BannerMessage" iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-BannerMessage="iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-BannerMessage">Banner Message</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/iOS_Interactive_Notifications-section-40930452_iOSInteractiveNotifications-LockScreenorNotificationCenter" iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-LockScreenorNotificationCenter="iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-LockScreenorNotificationCenter">Lock Screen or Notification Center</a> </p>
</li></ul></li><li class=" "> <p>
<a class="document-link " href="#!/guide/iOS_Interactive_Notifications-section-40930452_iOSInteractiveNotifications-CreateaNotificationAction" iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-CreateaNotificationAction="iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-CreateaNotificationAction">Create a Notification Action</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/iOS_Interactive_Notifications-section-40930452_iOSInteractiveNotifications-CreateaNotificationCategory" iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-CreateaNotificationCategory="iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-CreateaNotificationCategory">Create a Notification Category</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/iOS_Interactive_Notifications-section-40930452_iOSInteractiveNotifications-RegisterNotificationCategories" iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-RegisterNotificationCategories="iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-RegisterNotificationCategories">Register Notification Categories</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/iOS_Interactive_Notifications-section-40930452_iOSInteractiveNotifications-MonitorInteractiveNotifications" iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-MonitorInteractiveNotifications="iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-MonitorInteractiveNotifications">Monitor Interactive Notifications</a> </p>
<ul class="toc-indentation "><li class=" "> <p>
<a class="document-link " href="#!/guide/iOS_Interactive_Notifications-section-40930452_iOSInteractiveNotifications-localnotificationaction" iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-localnotificationaction="iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-localnotificationaction">localnotificationaction</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/iOS_Interactive_Notifications-section-40930452_iOSInteractiveNotifications-remotenotificationaction" iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-remotenotificationaction="iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-remotenotificationaction">remotenotificationaction</a> </p>
</li></ul></li><li class=" "> <p>
<a class="document-link " href="#!/guide/iOS_Interactive_Notifications-section-40930452_iOSInteractiveNotifications-ScheduleanInteractiveLocalNotification" iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-ScheduleanInteractiveLocalNotification="iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-ScheduleanInteractiveLocalNotification">Schedule an Interactive Local Notification</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/iOS_Interactive_Notifications-section-40930452_iOSInteractiveNotifications-SendanInteractivePushNotification" iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-SendanInteractivePushNotification="iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-SendanInteractivePushNotification">Send an Interactive Push Notification</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/iOS_Interactive_Notifications-section-40930452_iOSInteractiveNotifications-Example" iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-Example="iOS_Interactive_Notifications.html#40930452_iOSInteractiveNotifications-Example">Example</a> </p>
</li></ul> <div class="section section-2 " id="40930452_iOSInteractiveNotifications-Introduction">
<h2 class="heading "><span>Introduction</span></h2>
<p>
Starting with Release 3.4.0, you can create interactive notifications, where users can respond to application notifications without launching the application to the foreground.  The user needs to reveal notification actions in the notification, then press a notification action to respond to the notification.  This feature is available on devices running iOS 8 or later.    </p>
<p>
To create an interactive notification, the applications needs to:    </p>
<ol class=" "><li class=" "> <p>
Create and configure notification actions    </p>
</li><li class=" "> <p>
Create notification categories and assign notification actions to them    </p>
</li><li class=" "> <p>
Register the notification categories    </p>
</li><li class=" "> <p>
Monitor the <tt class=" ">localnotificationaction</tt> event to respond to local notifications and the <tt class=" ">remotenotificationaction</tt> event to respond to push notifications    </p>
</li></ol> </div>
<div class="section section-2 " id="40930452_iOSInteractiveNotifications-InteractiveNotificationTypes">
<h2 class="heading "><span>Interactive Notification Types</span></h2>
<p>
The following screen shots illustrate how iOS presents and the user interacts with the notification:    </p>
<div class="section section-3 " id="40930452_iOSInteractiveNotifications-AlertDialog">
<h3 class="heading "><span>Alert Dialog</span></h3>
<p>
The user needs to tap the <strong class=" ">Options</strong> button when the alert dialog first appears to display the notification actions. Tapping <strong class=" ">Open</strong> launches the application in the foreground, while tapping <strong class=" ">Close</strong> dismisses the notification.    </p>
<p>
<img src="images/download/attachments/40929226/InteractiveAlertDialog.png" alt="images/download/attachments/40929226/InteractiveAlertDialog.png" class="confluence-embedded-image" />
</p>
</div>
<div class="section section-3 " id="40930452_iOSInteractiveNotifications-BannerMessage">
<h3 class="heading "><span>Banner Message</span></h3>
<p>
In a banner message, the user needs to swipe the banner message down to reveal the notification actions. Tapping the notification (not an action) launches the application in the foreground. The user can dismiss the notification by swiping up the notification tray.    </p>
<p>
<img src="images/download/attachments/40929226/InteractiveBannerMessage.png" alt="images/download/attachments/40929226/InteractiveBannerMessage.png" class="confluence-embedded-image" />
</p>
</div>
<div class="section section-3 " id="40930452_iOSInteractiveNotifications-LockScreenorNotificationCenter">
<h3 class="heading "><span>Lock Screen or Notification Center</span></h3>
<p>
In the lock screen or notification center, the user needs to swipe the notification to the left to reveal the notification actions. If the user swipes the notification to the right in the locked screen, the application is launched in the foreground. The user can dismiss the notification by tapping the <strong class=" ">x </strong>button.    </p>
<p>
<img src="images/download/attachments/40929226/LockedScreenInteractiveNotiifcation.png" alt="images/download/attachments/40929226/LockedScreenInteractiveNotiifcation.png" class="confluence-embedded-image" />
</p>
</div>
</div>
<div class="section section-2 " id="40930452_iOSInteractiveNotifications-CreateaNotificationAction">
<h2 class="heading "><span>Create a Notification Action</span></h2>
<p>
A notification action is an action that the application performs in response to a notification.  The action is represented as a button in the notification.    </p>
<p>
To create a notification action, use the <tt class=" ">Titanium.App.iOS.createUserNotificationAction()</tt> method.  Pass the method a dictionary with the following required properties:    </p>
<ul class=" "><li class=" "> <p>
<tt class=" ">activationMode</tt>:    </p>
<ul class=" "><li class=" "> <p>
Set to <tt class=" ">Titanium.App.iOS.USER_NOTIFICATION_ACTIVATION_MODE_BACKGROUND</tt> to activate the application in the background to respond to the action unless the application is already in the foreground.    </p>
</li><li class=" "> <p>
Set to <tt class=" ">Titanium.App.iOS.USER_NOTIFICATION_ACTIVATION_MODE_FOREGROUND</tt> to launch the application in the foreground to respond to the action.    </p>
</li></ul></li><li class="p1 "> <p>
<tt class=" ">authenticationRequired</tt>: set to true if the action requires the device to be unlocked.    </p>
</li><li class=" "> <p>
<tt class=" ">destructive</tt>: set to true if the action causes destructive behavior to the user's data or the application.  The action appears red in the locked screen and notification center instead of the default color.    </p>
</li><li class=" "> <p>
<tt class=" ">identifier</tt>: string identifier of the action.  Used to identify the action the user pressed.    </p>
</li><li class=" "> <p>
<tt class=" ">title</tt>: title of the button to display in the notification    </p>
</li></ul><div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="comments">// The following action launches the application in the foreground and requires the device to be unlocked</code></div>
<div class="line"><code class="plain">var acceptAction = Ti.App.iOS.createUserNotificationAction({</code></div>
<div class="line"><code class="plain">    identifier: </code><code class="string">"ACCEPT_IDENTIFIER"</code><code class="plain">,</code></div>
<div class="line"><code class="plain">    title: </code><code class="string">"Accept"</code><code class="plain">,</code></div>
<div class="line"><code class="plain">    activationMode: Ti.App.iOS.USER_NOTIFICATION_ACTIVATION_MODE_FOREGROUND,</code></div>
<div class="line"><code class="plain">    destructive: </code><code class="keyword">false</code><code class="plain">,</code></div>
<div class="line"><code class="plain">    authenticationRequired: </code><code class="keyword">true</code></div>
<div class="line"><code class="plain">});</code></div>
<div class="line"><code class="comments">// The following action will only activate the application in the background, requires the device to be unlocked, and may have a red background. </code></div>
<div class="line"><code class="plain">var rejectAction = Ti.App.iOS.createUserNotificationAction({</code></div>
<div class="line"><code class="plain">    identifier: </code><code class="string">"REJECT_IDENTIFIER"</code><code class="plain">,</code></div>
<div class="line"><code class="plain">    title: </code><code class="string">"Reject"</code><code class="plain">,</code></div>
<div class="line"><code class="plain">    activationMode: Ti.App.iOS.USER_NOTIFICATION_ACTIVATION_MODE_BACKGROUND,</code></div>
<div class="line"><code class="plain">    destructive: </code><code class="keyword">true</code><code class="plain">,</code></div>
<div class="line"><code class="plain">    authenticationRequired: </code><code class="keyword">true</code></div>
<div class="line"><code class="plain">});</code></div>
</div>
</div> </div>
<div class="section section-2 " id="40930452_iOSInteractiveNotifications-CreateaNotificationCategory">
<h2 class="heading "><span>Create a Notification Category</span></h2>
<p>
A notification category is a group of notification actions for a specific notification.  The notification category allows the application to customize the notification options based on which notification style is used.  For alert dialogs, only four notification actions can be displayed, while all other notifications can only display two actions.    </p>
<p>
To create a notification action, use the <tt class=" ">Titanium.App.iOS.createUserNotificationCategory()</tt> method.  Pass the method a dictionary with the following properties:    </p>
<ul class=" "><li class="p1 "> <p>
<tt class=" ">actionsForDefaultContext</tt>: Array of notification action objects to associate with the group.  Note that only the first four actions can be displayed for an alert dialog and the first two actions can be displayed for all other notifications.    </p>
</li><li class="p1 "> <p>
<tt class=" ">actionsForMinimalContext</tt>: Array of notification action objects to display for non-dialog-style notifications.  If not specified, the first two actions from <tt class=" ">actionsForDefaultContent</tt> are displayed.    </p>
</li><li class="p1 "> <p>
<tt class=" ">identifier</tt>: string identifier of the group of actions.  When scheduling a notification, pass this value to the <tt class=" ">category</tt> property.    </p>
</li></ul><div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">var invitationCategory = Ti.App.iOS.createUserNotificationCategory({</code></div>
<div class="line"><code class="plain">    identifier: </code><code class="string">"INVITE_CATEGORY"</code><code class="plain">,</code></div>
<div class="line"><code class="plain"> </code><code class="comments">// The following actions will be displayed for an alert dialog</code></div>
<div class="line"><code class="plain">    actionsForDefaultContext: [acceptAction, rescheduleAction, delayAction, rejectAction],</code></div>
<div class="line"><code class="plain"> </code><code class="comments">// The following actions will be displayed for all other notifications</code></div>
<div class="line"><code class="plain">    actionsForMinimalContext: [acceptAction, rejectAction]</code></div>
<div class="line"><code class="plain">});</code></div>
</div>
</div> </div>
<div class="section section-2 " id="40930452_iOSInteractiveNotifications-RegisterNotificationCategories">
<h2 class="heading "><span>Register Notification Categories</span></h2>
<p>
Like notification types, you also need to register notification categories with iOS by using the <tt class=" ">Titanium.App.iOS.registerUserNotificationSettings()</tt> method.  Pass the method a dictionary with the <tt class=" ">type</tt> property set to the notification types to use and the <tt class=" ">categories</tt> property to an array of notification category objects the application needs to use.    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">Ti.App.iOS.registerUserNotificationSettings({</code></div>
<div class="line"><code class="plain">    types: [Ti.App.iOS.USER_NOTIFICATION_TYPE_ALERT, Ti.App.iOS.USER_NOTIFICATION_TYPE_BADGE],</code></div>
<div class="line"><code class="plain">    categories: [invitationCategory, downloadCategory]</code></div>
<div class="line"><code class="plain">});</code></div>
</div>
</div> <p>
If you are using push notifications, the application needs to call the <tt class=" ">Titanium.Network.registerForPushNotifications()</tt> method.  The application should monitor the <tt class=" ">usernotificationsettings</tt> to register for push notifications.    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">function registerForPush() {</code></div>
<div class="line"><code class="plain">   Ti.Network.registerForPushNotifications({</code></div>
<div class="line"><code class="plain">       success: deviceTokenSuccess,</code></div>
<div class="line"><code class="plain">       error: deviceTokenError,</code></div>
<div class="line"><code class="plain">       callback: receivePush</code></div>
<div class="line"><code class="plain">   });</code></div>
<div class="line"><code class="plain"> </code><code class="comments">// Remove event listener once registered for push notifications</code></div>
<div class="line"><code class="plain">   Ti.App.iOS.removeEventListener(</code><code class="string">'usernotificationsettings'</code><code class="plain">, registerForPush); </code></div>
<div class="line"><code class="plain">};</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="comments">// Wait for user settings to be registered before registering for push notifications</code></div>
<div class="line"><code class="plain">Ti.App.iOS.addEventListener(</code><code class="string">'usernotificationsettings'</code><code class="plain">, registerForPush);</code></div>
</div>
</div> </div>
<div class="section section-2 " id="40930452_iOSInteractiveNotifications-MonitorInteractiveNotifications">
<h2 class="heading "><span>Monitor Interactive Notifications</span></h2>
<p>
The application can monitor interactive notifications and respond to them in the background by using the iOS application-level <tt class=" ">localnotificationaction</tt> event for location notifications and <tt class=" ">remotenotificationaction</tt> event for push notifications.  The event is triggered when the user selects a notification action.    </p>
<div class="section section-3 " id="40930452_iOSInteractiveNotifications-localnotificationaction">
<h3 class="heading "><span>localnotificationaction</span></h3>
<p>
Monitor the iOS application-level <tt class=" ">localnotificationaction</tt> event to respond to an interactive local notification.  The event is passed the same object as the <tt class=" ">notification</tt> event except it returns two extra properties:    </p>
<ul class=" "><li class=" "> <p>
<tt class=" ">category</tt>: string identifier indicating the notification category that triggered the event    </p>
</li><li class=" "> <p>
<tt class=" ">identifier</tt>: string identifier indicating the notification action the user pressed    </p>
</li></ul> <p>
Use the properties to have the application decide how to respond to the interactive notification.    </p>
<p>
</p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">Ti.App.iOS.addEventListener(</code><code class="string">'localnotificationaction'</code><code class="plain">, function(e) {</code></div>
<div class="line"><code class="plain"> </code><code class="comments">// Switch for categories</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">switch</code><code class="plain"> (e.category) {</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">case</code><code class="plain"> </code><code class="string">"DOWNLOAD_CATEGORY"</code><code class="plain">:</code></div>
<div class="line"><code class="plain"> </code><code class="comments">// Switch for actions</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">switch</code><code class="plain"> (e.identifier) {</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">case</code><code class="plain"> </code><code class="string">"ACCEPT_IDENTIFIER"</code><code class="plain">:</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">if</code><code class="plain"> (e.userInfo &amp;&amp; </code><code class="string">"url"</code><code class="plain"> in e.userInfo){</code></div>
<div class="line"><code class="plain">                        httpGetRequest(e.userInfo.url);</code></div>
<div class="line"><code class="plain">                    }</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain"> </code><code class="comments">// more actions...</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain"> </code><code class="comments">// more categories...</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">default</code><code class="plain">:</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    };</code></div>
<div class="line"><code class="plain">});	</code></div>
</div>
</div> </div>
<div class="section section-3 " id="40930452_iOSInteractiveNotifications-remotenotificationaction">
<h3 class="heading "><span>remotenotificationaction</span></h3>
<p>
Monitor the iOS application-level <tt class=" ">remotenotificationaction</tt> event to respond to an interactive push notification.  The event is passed an object with the following properties:    </p>
<ul class=" "><li class=" "> <p>
<tt class=" ">category</tt>: string identifier indicating the notification category that triggered the event    </p>
</li><li class=" "> <p>
<tt class=" ">data</tt>: push notification payload as a JSON object    </p>
</li><li class=" "> <p>
<tt class=" ">identifier</tt>: string identifier indicating the notification action the user pressed    </p>
</li></ul> <p>
Use the properties to have the application decide how to respond to the interactive notification.    </p>
<p>
</p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">Ti.App.iOS.addEventListener(</code><code class="string">'remotenotificationaction'</code><code class="plain">, function(e) {</code></div>
<div class="line"><code class="plain"> </code><code class="comments">// Switch for categories</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">switch</code><code class="plain"> (e.category) {</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">case</code><code class="plain"> </code><code class="string">"DOWNLOAD_CATEGORY"</code><code class="plain">:</code></div>
<div class="line"><code class="plain"> </code><code class="comments">// Switch for actions</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">switch</code><code class="plain"> (e.identifier) {</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">case</code><code class="plain"> </code><code class="string">"ACCEPT_IDENTIFIER"</code><code class="plain">:</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">if</code><code class="plain"> (e.data &amp;&amp; </code><code class="string">"url"</code><code class="plain"> in e.data){</code></div>
<div class="line"><code class="plain">                        httpGetRequest(e.data.url);</code></div>
<div class="line"><code class="plain">                    }</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain"> </code><code class="comments">// more actions...</code></div>
<div class="line"><code class="plain">            }</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain"> </code><code class="comments">// more categories...</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">default</code><code class="plain">:</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">break</code><code class="plain">;</code></div>
<div class="line"><code class="plain">    };</code></div>
<div class="line"><code class="plain">});</code></div>
</div>
</div> <p>
</p>
</div>
</div>
<div class="section section-2 " id="40930452_iOSInteractiveNotifications-ScheduleanInteractiveLocalNotification">
<h2 class="heading "><span>Schedule an Interactive Local Notification</span></h2>
<p>
To send an interactive local notification, use the <tt class=" ">Titanium.App.iOS.scheduleLocalNotification()</tt> method.  Use it the same way when scheduling a non-interactive local notifications except when creating the dictionary of options to pass to the method, the application must specify the <tt class=" ">category</tt> property and set it to the <tt class=" ">identifier</tt> of the notification category to use.  The notification category indicates which group of actions to use with the notification.  The notification category must also be registered or else the notification will be presented as a default non-interactive notification.    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">Ti.App.iOS.scheduleLocalNotification({</code></div>
<div class="line"><code class="plain">    date: </code><code class="keyword">new</code><code class="plain"> Date(</code><code class="keyword">new</code><code class="plain"> Date().getTime() + </code><code class="value">3000</code><code class="plain">),</code></div>
<div class="line"><code class="plain">    alertBody: </code><code class="string">"New content available! Download now?"</code><code class="plain">,</code></div>
<div class="line"><code class="plain">    badge: </code><code class="value">1</code><code class="plain">,</code></div>
<div class="line"><code class="plain">    userInfo: {</code><code class="string">"url"</code><code class="plain">: </code><code class="string">"http://www.download.com/resource/asset.json"</code><code class="plain">},</code></div>
<div class="line"><code class="plain">    category: </code><code class="string">"DOWNLOAD_CATEGORY"</code></div>
<div class="line"><code class="plain">});</code></div>
</div>
</div> </div>
<div class="section section-2 p1" id="40930452_iOSInteractiveNotifications-SendanInteractivePushNotification">
<h2 class="heading p1"><span>Send an Interactive Push Notification</span></h2>
<p class="p2">
To send an interactive push notification, send a payload with the category field set to the identifier of the notification category to use.    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">{</code></div>
<div class="line"><code class="plain"> </code><code class="string">"alert"</code><code class="plain">: </code><code class="string">"New content available! Download now?"</code><code class="plain">,</code></div>
<div class="line"><code class="plain"> </code><code class="string">"badge"</code><code class="plain">: </code><code class="value">1</code><code class="plain">,</code></div>
<div class="line"><code class="plain"> </code><code class="string">"url"</code><code class="plain">: </code><code class="string">"http://www.download.com/resource/asset.json"</code><code class="plain">,</code></div>
<div class="line"><code class="plain"> </code><code class="string">"category"</code><code class="plain">: </code><code class="string">"DOWNLOAD_CATEGORY"</code><code class="plain"> </code></div>
<div class="line"><code class="plain">}</code></div>
</div>
</div> <p>
To send the payload, you can use either the:    </p>
<ul class=" "><li class=" "> <p>
Appcelerator Dashboard: <a class="external-link external-link" href="/platform/latest/#!/guide/Sending_and_Scheduling_Push_Notifications">Sending and Scheduling Push Notifications</a> </p>
</li><li class=" "> <p>
My Apps: <a class="external-link external-link" href="https://my.appcelerator.com" target="_blank">https://my.appcelerator.com</a> </p>
</li><li class="p2 "> <p>
Titanium Cloud Module (ti.cloud) APIs: <a class="external-link external-link" href="#!/api/Titanium.Cloud.PushNotifications-method-notify">Cloud.PushNotifications.notify()</a> or <a class="external-link external-link" href="#!/api/Titanium.Cloud.PushNotifications-method-notifyTokens">Cloud.PushNotifications.notifyTokens()</a> </p>
</li><li class="p4 "> <p>
ACS REST APIs: <a class="external-link external-link" href="/cloud/latest/#!/api/PushNotifications-method-notify">PushNotification.notify</a> or <a class="external-link external-link" href="/cloud/latest/#!/api/PushNotifications-method-notify_token">PushNotification.notify_tokens</a> </p>
</li></ul> <p class="p4">
</p>
</div>
<div class="section section-2 p4" id="40930452_iOSInteractiveNotifications-Example">
<h2 class="heading p4"><span>Example</span></h2>
<p>
In the following example, run the code on an iOS device or simulator.  Click the &quot;Trigger Notification&quot; button, then either lock the phone or place the application in the background.  You will have three seconds or else the application will respond to the notification in the foreground.  If the device or simulator is running iOS 8 or later, you will receive the interactive local notification.  If not, you will receive a regular local notification.    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="comments">// Check for iOS 8 or greater</code></div>
<div class="line"><code class="keyword">if</code><code class="plain"> (Ti.Platform.name == </code><code class="string">"iPhone OS"</code><code class="plain"> &amp;&amp; parseInt(Ti.Platform.version.split(</code><code class="string">"."</code><code class="plain">)[</code><code class="value">0</code><code class="plain">]) &gt;= </code><code class="value">8</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">    Ti.API.info(</code><code class="string">"I am iOS 8!"</code><code class="plain">);</code></div>
<div class="line"><code class="plain"> </code><code class="comments">// Create notification actions</code></div>
<div class="line"><code class="plain">    var acceptAction = Ti.App.iOS.createUserNotificationAction({</code></div>
<div class="line"><code class="plain">        identifier: </code><code class="string">"ACCEPT_IDENTIFIER"</code><code class="plain">,</code></div>
<div class="line"><code class="plain">        title: </code><code class="string">"Accept"</code><code class="plain">,</code></div>
<div class="line"><code class="plain">        activationMode: Ti.App.iOS.USER_NOTIFICATION_ACTIVATION_MODE_FOREGROUND,</code></div>
<div class="line"><code class="plain">        destructive: </code><code class="keyword">false</code><code class="plain">,</code></div>
<div class="line"><code class="plain">        authenticationRequired: </code><code class="keyword">true</code></div>
<div class="line"><code class="plain">    });</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="plain">    var rejectAction = Ti.App.iOS.createUserNotificationAction({</code></div>
<div class="line"><code class="plain">        identifier: </code><code class="string">"REJECT_IDENTIFIER"</code><code class="plain">,</code></div>
<div class="line"><code class="plain">        title: </code><code class="string">"Reject"</code><code class="plain">,</code></div>
<div class="line"><code class="plain">        activationMode: Ti.App.iOS.USER_NOTIFICATION_ACTIVATION_MODE_BACKGROUND,</code></div>
<div class="line"><code class="plain">        destructive: </code><code class="keyword">true</code><code class="plain">,</code></div>
<div class="line"><code class="plain">        authenticationRequired: </code><code class="keyword">false</code></div>
<div class="line"><code class="plain">    });</code></div>
<div class="line"><code class="plain"> </code><code class="comments">// Create a notification category</code></div>
<div class="line"><code class="plain">    var downloadContent = Ti.App.iOS.createUserNotificationCategory({</code></div>
<div class="line"><code class="plain">      identifier: </code><code class="string">"DOWNLOAD_CONTENT"</code><code class="plain">,</code></div>
<div class="line"><code class="plain">      actionsForDefaultContext: [acceptAction, rejectAction]</code></div>
<div class="line"><code class="plain">    });    </code></div>
<div class="line"><code class="plain"> </code><code class="comments">// Register for user notifications and categories</code></div>
<div class="line"><code class="plain">    Ti.App.iOS.registerUserNotificationSettings({</code></div>
<div class="line"><code class="plain">        types: [</code></div>
<div class="line"><code class="plain">            Ti.App.iOS.USER_NOTIFICATION_TYPE_ALERT,</code></div>
<div class="line"><code class="plain">            Ti.App.iOS.USER_NOTIFICATION_TYPE_BADGE,</code></div>
<div class="line"><code class="plain">            Ti.App.iOS.USER_NOTIFICATION_TYPE_SOUND</code></div>
<div class="line"><code class="plain">        ],</code></div>
<div class="line"><code class="plain">        categories: [downloadContent]</code></div>
<div class="line"><code class="plain">    });</code></div>
<div class="line"><code class="plain"> </code><code class="comments">// Monitor notifications received while app is in the background</code></div>
<div class="line"><code class="plain">    Ti.App.iOS.addEventListener(</code><code class="string">'localnotificationaction'</code><code class="plain">, function(e) {</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">if</code><code class="plain"> (e.category == </code><code class="string">"DOWNLOAD_CONTENT"</code><code class="plain"> &amp;&amp; e.identifier == </code><code class="string">"ACCEPT_IDENTIFIER"</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">            alert(</code><code class="string">"start download"</code><code class="plain">);</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="plain"> </code><code class="comments">// Reset the badge value</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">if</code><code class="plain"> (e.badge &gt; </code><code class="value">0</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">            Ti.App.iOS.scheduleLocalNotification({</code></div>
<div class="line"><code class="plain">                date: </code><code class="keyword">new</code><code class="plain"> Date(</code><code class="keyword">new</code><code class="plain"> Date().getTime() + </code><code class="value">3000</code><code class="plain">),</code></div>
<div class="line"><code class="plain">                badge: </code><code class="string">"-1"</code></div>
<div class="line"><code class="plain">            });</code></div>
<div class="line"><code class="plain">        }</code></div>
<div class="line"><code class="plain">        Ti.API.info(JSON.stringify(e));</code></div>
<div class="line"><code class="plain">    });</code></div>
<div class="line"><code class="plain">}</code></div>
<div class="line"><code class="comments">// Monitor notifications received while app is in the foreground </code></div>
<div class="line"><code class="plain">Ti.App.iOS.addEventListener(</code><code class="string">'notification'</code><code class="plain">, function(e) { </code></div>
<div class="line"><code class="plain"> </code><code class="comments">// Reset the badge value</code></div>
<div class="line"><code class="plain"> </code><code class="keyword">if</code><code class="plain"> (e.badge &gt; </code><code class="value">0</code><code class="plain">) {</code></div>
<div class="line"><code class="plain">        Ti.App.iOS.scheduleLocalNotification({</code></div>
<div class="line"><code class="plain">            date: </code><code class="keyword">new</code><code class="plain"> Date(</code><code class="keyword">new</code><code class="plain"> Date().getTime() + </code><code class="value">3000</code><code class="plain">),</code></div>
<div class="line"><code class="plain">            badge: </code><code class="string">"-1"</code></div>
<div class="line"><code class="plain">        });</code></div>
<div class="line"><code class="plain">    }</code></div>
<div class="line"><code class="plain">    Ti.API.info(JSON.stringify(e));</code></div>
<div class="line"><code class="plain">});</code></div>
<div class="line"><code class="comments">// App UI</code></div>
<div class="line"><code class="plain">var win = Ti.UI.createWindow({backgroundColor: </code><code class="string">'white'</code><code class="plain">});</code></div>
<div class="line"><code class="plain">var button = Ti.UI.createButton({title: </code><code class="string">'Trigger Notification'</code><code class="plain">});</code></div>
<div class="line"><code class="plain">button.addEventListener(</code><code class="string">'click'</code><code class="plain">, function(e){ </code></div>
<div class="line"><code class="plain"> </code><code class="comments">// Send a notification in 3 seconds</code></div>
<div class="line"><code class="plain">    var note = Ti.App.iOS.scheduleLocalNotification({</code></div>
<div class="line"><code class="plain">        date: </code><code class="keyword">new</code><code class="plain"> Date(</code><code class="keyword">new</code><code class="plain"> Date().getTime() + </code><code class="value">3000</code><code class="plain">),</code></div>
<div class="line"><code class="plain">        alertBody: </code><code class="string">"New content available! Download now?"</code><code class="plain">,</code></div>
<div class="line"><code class="plain">        badge: </code><code class="value">1</code><code class="plain">,</code></div>
<div class="line"><code class="plain">        userInfo: {</code><code class="string">"url"</code><code class="plain">: </code><code class="string">"http://www.download.com/resource/asset.json"</code><code class="plain">, id:</code><code class="string">"1"</code><code class="plain">},</code></div>
<div class="line"><code class="plain">        category: </code><code class="string">"DOWNLOAD_CONTENT"</code></div>
<div class="line"><code class="plain">    });    </code></div>
<div class="line"><code class="plain">});</code></div>
<div class="line"><code class="plain">win.add(button);</code></div>
<div class="line"><code class="plain">win.open();</code></div>
</div>
</div> <p>
</p>
<p>
</p>
</div>
</div>
<div class="footer">
            Created with <a href="http://k15t.com/display/web/Scroll-Wiki-EclipseHelp-Exporter-for-Confluence" target="_blank">Scroll EclipseHelp Exporter for Confluence</a>.
        </div>
</div>
</body>
</html>
