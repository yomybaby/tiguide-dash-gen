<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>PyDev Jython Scripting</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta content="Scroll EclipseHelp Exporter" name="generator" />
<link type="text/css" rel="stylesheet" />
<link type="text/css" rel="stylesheet" />
<link type="text/css" rel="stylesheet" media="print" />
</head>
<body>
<div class="container">
<div class="header"></div>
<div id="30083078" class="content"><a id="editButton" href="https://wiki.appcelerator.org/pages/editpage.action?pageId=30083078"><span>Edit</span></a>
<h1>PyDev Jython Scripting</h1>
<div class="section section-2 " id="30083078_PyDevJythonScripting-ScriptingPyDevwithJython">
<h2 class="heading "><span>Scripting PyDev with Jython</span></h2>
<p>
Version 1.0.4 has added the option of <strong class=" ">scripting PyDev with Jython</strong>, and this article aims at explaining how it works and how to add your own scripts to PyDev.    </p>
<p>
What we will see is the integration that will allow you to listen to the events generated by the editor (PyEdit class) and respond accordingly.    </p>
<p>
<strong class=" ">NOTE</strong>: In the end of this article, there are links to view things at the cvs with the referenced classes.    </p>
<p>
The examples that we will see are located in the project <strong class=" ">org.python.pydev.jython</strong> under the folder <strong class=" ">jysrc</strong>.    </p>
<p>
The first thing you'll want to do is configure the preferences so that you can see the output of the scripts in the console (so that you can do some prints and actually see them).    </p>
<p>
<img src="images/pydev.org/images/scripting/scripting_prefs.png" alt="images/pydev.org/images/scripting/scripting_prefs.png" class="confluence-embedded-image confluence-external-resource confluence-content-image-border" />
</p>
<p>
Now that you have your preferences correctly set, let's make some changes to see what we can play with... You just need PyDev installed (we will change the scripts that come with the default installation, so, there is no need to actually download the PyDev sources, altough it might be worth getting it for having it as a reference).    </p>
<p>
So, in your PyDev installation, go to the <strong class=" ">jysrc</strong> folder of the <strong class=" ">org.python.pydev.jython plugin</strong> that is part of PyDev (this is located under the eclipse install... something as <strong class=" ">.../eclipse/plugins/org.python.pydev.jython_1.0.4/jysrc</strong>)    </p>
<p>
You'll notice some files that start with <strong class=" ">pyedit_</strong> (there could be many, but for this article, we'll only care about <strong class=" ">pyedit_example.py</strong>, <strong class=" ">pyedit_example2.py</strong> and <strong class=" ">pyedit_next_problem.py</strong>).    </p>
<p>
The first thing you want to know about is that the name of the script is something important in the integration. All the scripts that will listen to the PyEdit class (this is the PyDev Editor) have to start with <strong class=" ">pyedit_</strong>. Another interesting thing is that changes are gathered without the need of restarting Eclipse (but as we will be listening to the editor, you might have to reopen it, so that it triggers all of the events we may want to listen).    </p>
<p>
So, now that you're ready, let's open the file <strong class=" ">pyedit_example.py</strong> and uncomment the last line of code. After, if you close a PyDev Editor and open it again, you'll notice that you'll have some messages showing in the console, with the 'print' statement that was uncommented (and now, if you go and comment it again, you'll stop seeing the messages again, so, you can see that all the <strong class=" ">changes are automatically reloaded whenever you change the script</strong>).    </p>
<p>
<strong class=" ">TIP</strong>: You may just drag and drop files from your filesystem into PyDev to edit those files.    </p>
<p>
The image below shows the ouput you should get from uncommenting the line in the example above.    </p>
<p>
<img src="images/pydev.org/images/scripting/scripting_output.png" alt="images/pydev.org/images/scripting/scripting_output.png" class="confluence-embedded-image confluence-external-resource confluence-content-image-border" />
</p>
<p>
Now that you've already seen how 'easy' it should be to change an existing script and get it to work, let's now create our own script.    </p>
<p>
The first thing you want to do is create a jython project (call it pydev_scripts), then, go to the scripting preferences and put the <strong class=" ">src</strong> directory from that project in the <strong class=" ">Location of additional scripts</strong>.    </p>
<p>
Now, under the src folder of that project, create a <strong class=" ">pyedit_test1.py</strong> file. Just write <strong class=" ">print '&gt;&gt;', cmd</strong> and save it... When you save it, you'll notice in the console something as:    </p>
<blockquote>
<p>
---&gt; reloading<br />E:/eclipse_testing_workspace/pydev_additional_scripts/src/pyedit_test1.py<br />&gt;&gt; onSave    </p>
</blockquote>
<p>
You will receive (currently) 4 commands:    </p>
<ul class="alternate "><li class=" "> <p>
<strong class=" ">onSetDocument</strong>: You can then link your commands to listen to changes in the document if you want (besides the standard 'editor' and 'cmd' variables, you will also be able to have access to a 'document' variable (it is an IDocument).    </p>
</li><li class=" "> <p>
<strong class=" ">onCreateActions</strong>: It is called only once when the actions are being created. You should handle it to add your own actions in the PyEdit (the pyedit_example2.py shows the default way of doing this)    </p>
</li><li class=" "> <p>
<strong class=" ">onSave</strong>: want to do something when the PyEdit saves its content? That's your chance...    </p>
</li><li class=" "> <p>
<strong class=" ">onDispose</strong>: Called when the PyEdit is going to dispose itself.    </p>
</li></ul> <p>
And that's it. We've seen how to create scripts and make PyDev load them for editor actions. If you want to keep on, you should check some example scripts that come with PyDev (those come in the org.python.pydev.jython_xxx/jysrc folder &ndash; there are links to them in the resources section in the end of this page). You should check:    </p>
<ul class="alternate "><li class=" "> <p>
<strong class=" ">pyedit_example.py</strong>: this is the simple example we covered here, to see the output of the commands we have    </p>
</li><li class=" "> <p>
<strong class=" ">pyedit_example2.py</strong>: this is an example on how to bind some action to the <strong class=" ">'default' keybindig structure</strong> that is provided by PyDev for jython scripts.    </p>
</li><li class=" "> <p>
<strong class=" ">pyedit_next_problem.py</strong>: This is the implementation of the <strong class=" ">go to next problem</strong> that is implemented at PyDev. <strong class=" ">Disclaimer</strong>: the way it binds to the keybinding would require you to change the plugin.xml as it is based on the Eclipse structure, which is much more static than the way of binding things to the PyDev editor presented to you on pyedit_example2.py (it would require changes in the plugin.xml file of the plugin, but on the other way, it would also allow you to change the keybinding for it).    </p>
</li></ul> <p>
<strong class=" ">IMPORTANT NOTES:</strong> </p>
<ul class="alternate "><li class=" "> <p>
The directories that are added to the <strong class=" ">PYTHONPATH</strong> are the Lib dir from jython and the jysrc dir (both under the org.python.pydev.jython plugin).    </p>
</li><li class=" "> <p>
There is <strong class=" ">one interpreter</strong> for each PyEdit, so, while it is not reused across editors, it is <strong class=" ">reused in the same editor</strong>... So, be careful not to mess with global things. Ideally, you should only rely on things that the editor will pass you (such as the editor, the cmd, the document...)    </p>
</li><li class=" "> <p>
Some commands rely on having some specific command, so, you might not 'see' the change until you restart the editor (this is the case when registering actions depending on: <strong class=" ">onCreateActions</strong>).    </p>
</li><li class=" "> <p>
If you have further doubts about scripting, you can register at the <strong class=" ">pydev-code</strong> list at sourceforge, and ask them there, and if you've been able to create some nice, useful script, you can contribute it back to PyDev by creating a bug and attaching your script there.    </p>
</li></ul> <p>
So, that's it... Happy Scripting!    </p>
<p>
<strong class=" ">Resources</strong> (links to github)    </p>
<ul class="alternate "><li class=" "> <p>
<strong class=" "><a class="external-link external-link" href="http://github.com/aptana/Pydev/blob/f742ccc87a78a0dbf5fcd618561b3a91cdfbf5f5/plugins/org.python.pydev/src/org/python/pydev/editor/PyEdit.java" target="_blank">PyEdit.java </a></strong> </p>
</li><li class=" "> <p>
<strong class=" "><a class="external-link external-link" href="http://github.com/aptana/Pydev/tree/f742ccc87a78a0dbf5fcd618561b3a91cdfbf5f5/plugins/org.python.pydev.jython/jysrc" target="_blank">org.python.pydev.jythor/jysrc </a></strong> </p>
</li><li class=" "> <p>
<strong class=" "><a class="external-link external-link" href="http://github.com/aptana/Pydev/blob/f742ccc87a78a0dbf5fcd618561b3a91cdfbf5f5/plugins/org.python.pydev/src/org/python/pydev/editor/IPyEditListener.java" target="_blank">IPyEditListener.java </a></strong> </p>
</li><li class=" "> <p>
<strong class=" "><a class="external-link external-link" href="http://github.com/aptana/Pydev/blob/f742ccc87a78a0dbf5fcd618561b3a91cdfbf5f5/plugins/org.python.pydev/src/org/python/pydev/editor/scripting/PyEditScripting.java" target="_blank">PyEditScripting.java </a></strong> </p>
</li><li class=" "> <p>
<strong class=" "><a class="external-link external-link" href="http://github.com/aptana/Pydev/blob/f742ccc87a78a0dbf5fcd618561b3a91cdfbf5f5/plugins/org.python.pydev.jython/jysrc/pyedit_example.py" target="_blank">pyedit_example.py </a></strong> </p>
</li><li class=" "> <p>
<strong class=" "><a class="external-link external-link" href="http://github.com/aptana/Pydev/blob/f742ccc87a78a0dbf5fcd618561b3a91cdfbf5f5/plugins/org.python.pydev.jython/jysrc/pyedit_example2.py" target="_blank">pyedit_example2.py </a></strong> </p>
</li><li class=" "> <p>
<strong class=" "><a class="external-link external-link" href="http://github.com/aptana/Pydev/blob/f742ccc87a78a0dbf5fcd618561b3a91cdfbf5f5/plugins/org.python.pydev.jython/jysrc/pyedit_wrap_paragraph.py" target="_blank">pyedit_wrap_paragraph.py </a></strong> </p>
</li></ul> </div>
</div>
<div class="footer">
            Created with <a href="http://k15t.com/display/web/Scroll-Wiki-EclipseHelp-Exporter-for-Confluence" target="_blank">Scroll EclipseHelp Exporter for Confluence</a>.
        </div>
</div>
</body>
</html>
