<!-- single file version -->
<!DOCTYPE html>
<html>
<head>
  <link href="css/github.css" rel="stylesheet" type="text/css">
  <link href="resources/css/common.css" rel="stylesheet" type="text/css">
  <meta charset="utf-8" />
</head>
<body>

<div class="container">
<div class="header"></div>
<div id="29004815" class="content">
<h1>Maintaining a Custom AndroidManifest.xml</h1>
<div class="section section-2 " id="29004815_MaintainingaCustomAndroidManifest.xml-Contents">
<h2 class="heading "><span>Contents</span></h2>
<p>
</p>
<ul class="toc-indentation "><li class=" "> <p>
<a class="document-link " href="#!/guide/Maintaining_a_Custom_AndroidManifest.xml-section-29004815_MaintainingaCustomAndroidManifest.xml-Overview" maintaining_a_custom_androidmanifest.xml.html#29004815_maintainingacustomandroidmanifest.xml-overview="Maintaining_a_Custom_AndroidManifest.xml.html#29004815_MaintainingaCustomAndroidManifest.xml-Overview">Overview</a> </p>
</li><li class=" "> <p>
<a class="document-link " href="#!/guide/Maintaining_a_Custom_AndroidManifest.xml-section-29004815_MaintainingaCustomAndroidManifest.xml-Howitworks" maintaining_a_custom_androidmanifest.xml.html#29004815_maintainingacustomandroidmanifest.xml-howitworks="Maintaining_a_Custom_AndroidManifest.xml.html#29004815_MaintainingaCustomAndroidManifest.xml-Howitworks">How it works</a> </p>
<ul class="toc-indentation "><li class=" "> <p>
<a class="document-link " href="#!/guide/Maintaining_a_Custom_AndroidManifest.xml-section-29004815_MaintainingaCustomAndroidManifest.xml-CustomManifestEntriesintiapp.xml" maintaining_a_custom_androidmanifest.xml.html#29004815_maintainingacustomandroidmanifest.xml-custommanifestentriesintiapp.xml="Maintaining_a_Custom_AndroidManifest.xml.html#29004815_MaintainingaCustomAndroidManifest.xml-CustomManifestEntriesintiapp.xml">Custom Manifest Entries in tiapp.xml</a> </p>
</li></ul></li><li class=" "> <p>
<a class="document-link " href="#!/guide/Maintaining_a_Custom_AndroidManifest.xml-section-29004815_MaintainingaCustomAndroidManifest.xml-UsingaCustomManifest" maintaining_a_custom_androidmanifest.xml.html#29004815_maintainingacustomandroidmanifest.xml-usingacustommanifest="Maintaining_a_Custom_AndroidManifest.xml.html#29004815_MaintainingaCustomAndroidManifest.xml-UsingaCustomManifest">Using a Custom Manifest</a> </p>
<ul class="toc-indentation "><li class=" "> <p>
<a class="document-link " href="#!/guide/Maintaining_a_Custom_AndroidManifest.xml-section-29004815_MaintainingaCustomAndroidManifest.xml-EnsuringAndroidShutsDownAppsCleanly" maintaining_a_custom_androidmanifest.xml.html#29004815_maintainingacustomandroidmanifest.xml-ensuringandroidshutsdownappscleanly="Maintaining_a_Custom_AndroidManifest.xml.html#29004815_MaintainingaCustomAndroidManifest.xml-EnsuringAndroidShutsDownAppsCleanly">Ensuring Android Shuts Down Apps Cleanly</a> </p>
</li></ul></li></ul> </div>
<div class="section section-2 " id="29004815_MaintainingaCustomAndroidManifest.xml-Overview">
<h2 class="heading "><span>Overview</span></h2>
<p>
For the most part, if you have to add properties to the <tt class=" ">AndroidManifest.xml</tt> file, you can simply add them to the application&apos;s <tt class=" ">tiapp.xml</tt> file. If you encounter a setting that you can&apos;t override in <tt class=" ">tiapp.xml</tt>, you can create a custom <tt class=" ">AndroidManifest.xml</tt> file.    </p>
</div>
<div class="section section-2 " id="29004815_MaintainingaCustomAndroidManifest.xml-Howitworks">
<h2 class="heading "><span>How it works</span></h2>
<p>
When you create a new mobile application, you will now see an &quot;android&quot; section inside <tt class=" ">tiapp.xml</tt>. When empty, it just looks like this:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">&lt;android xmlns:android=</code><code class="string">&quot;http://schemas.android.com/apk/res/android&quot;</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">&lt;/android&gt;</code></div>
</div>
</div> <p>
Note we&apos;ve included the official Android namespace qualifier, and the reason for that is because we wanted the ability to take things out of this section and plop them right into the <tt class=" ">AndroidManifest.xml</tt> for you. To that end, things that you put inside of a &quot;manifest&quot; sub-element will be put into your android manifest for you at build time. See <a class="document-link " href="#!/guide/tiapp.xml_and_timodule.xml_Reference" tiapp.xml_and_timodule.xml_reference.html="tiapp.xml_and_timodule.xml_Reference.html">tiapp.xml and timodule.xml Reference</a> for details on elements that you can put in the <tt class=" ">tiapp.xml</tt> file.    </p>
<div class="section section-3 " id="29004815_MaintainingaCustomAndroidManifest.xml-CustomManifestEntriesintiapp.xml">
<h3 class="heading "><span>Custom Manifest Entries in tiapp.xml</span></h3>
<p>
For the most part, if you add a manifest entry to the <tt class=" ">tiapp.xml</tt> file, it replaces the entry in the generated file. Consider the following section of a tiapp.xml file:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">&lt;android xmlns:android=</code><code class="string">&quot;http://schemas.android.com/apk/res/android&quot;</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;manifest&gt;</code></div>
<div class="line"><code class="plain">        &lt;uses-sdk android:minSdkVersion=</code><code class="string">&quot;14&quot;</code><code class="plain"> /&gt;</code></div>
<div class="line"><code class="plain">        &lt;supports-screens</code></div>
<div class="line"><code class="plain">            android:smallScreens=</code><code class="string">&quot;false&quot;</code></div>
<div class="line"><code class="plain">            android:normalScreens=</code><code class="string">&quot;true&quot;</code></div>
<div class="line"><code class="plain">            android:largeScreens=</code><code class="string">&quot;true&quot;</code></div>
<div class="line"><code class="plain">            android:xlargeScreens=</code><code class="string">&quot;false&quot;</code></div>
<div class="line"><code class="plain">        /&gt;</code></div>
<div class="line"><code class="plain">    &lt;/manifest&gt;</code></div>
<div class="line"><code class="plain">&lt;/android&gt;</code></div>
</div>
</div> <p>
Most elements inside the <tt class=" ">&lt;manifest&gt;</tt> will be added as children to the <tt class=" ">&lt;manifest&gt;</tt> element inside of <tt class=" ">AndroidManifest.xml</tt> at build time, with some intelligence built in. The <tt class=" ">&lt;supports-screen&gt;</tt> tag in your tiapp.xml replaces the  default <tt class=" ">&lt;supports-screen&gt;</tt> tag.    </p>
<p>
The manifest&apos;s all-important <a class="external-link external-link" href="http://developer.android.com/guide/topics/manifest/application-element.html" target="_blank">&lt;application&gt;</a> element is handled differently. Your elements are applied additively, rather than replacing the <strong class=" ">whole</strong> <tt class=" ">&lt;application&gt;</tt> element.    </p>
<p>
For example, let&apos;s say you want the <tt class=" ">debuggable</tt> attribute of <tt class=" ">&lt;application&gt;</tt> to be set to <tt class=" ">true</tt> (it&apos;s false in the default manifest template), you can do this:    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">&lt;android xmlns:android=</code><code class="string">&quot;http://schemas.android.com/apk/res/android&quot;</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;manifest&gt;</code></div>
<div class="line"><code class="plain">        &lt;application android:debuggable=</code><code class="string">&quot;true&quot;</code><code class="plain"> /&gt;</code></div>
<div class="line"><code class="plain">    &lt;/manifest&gt;</code></div>
<div class="line"><code class="plain">&lt;/android&gt;</code></div>
</div>
</div> <p>
The official <a class="external-link external-link" href="http://developer.android.com/guide/topics/manifest/manifest-intro.html" target="_blank">Android Developers</a> website describes all the other elements that are supported, such as <tt class=" ">&lt;service&gt;</tt>, <tt class=" ">&lt;uses-permission&gt;</tt> and <tt class=" ">&lt;activity&gt;</tt> for instance, and these will be added using the same logic.    </p>
</div>
</div>
<div class="section section-2 " id="29004815_MaintainingaCustomAndroidManifest.xml-UsingaCustomManifest">
<h2 class="heading "><span>Using a Custom Manifest</span></h2>
<p>
In rare circumstances, you may still need to create a custom <tt class=" ">AndroidManifest.xml</tt>. If this is the case, be aware of the following advice:    </p>
<ul class=" "><li class=" "> <p>
Name the custom manifest  file <tt class=" ">AndroidManifest.xml</tt>, and put it in the directory <tt class=" ">platform/android</tt> beneath your application&apos;s root project directory.<br><br>Create the platform directory if you need to, ensuring that the directory is a sibling of the &quot;Resources&quot; directory, (right below your project root).    </p>
<img src="images/download/attachments/29004815/proj.png" alt="images/download/attachments/29004815/proj.png" class="confluence-embedded-image confluence-content-image-border">
<p>
</p>
</li><li class=" "> <p>
If you do have a custom manifest, generates a file named <tt class=" ">AndroidManifest.xml.gen</tt> in the <tt class=" ">build/android</tt> directory during each build. You can use this to see the <tt class=" ">AndroidManifest.xml</tt> that would be generated by default.    </p>
</li></ul> <div class="section section-3 " id="29004815_MaintainingaCustomAndroidManifest.xml-EnsuringAndroidShutsDownAppsCleanly">
<h3 class="heading "><span>Ensuring Android Shuts Down Apps Cleanly</span></h3>
<p>
The are times when an application needs to be shut down by the platform outside of the application context, such as when the user changes fundamental system settings or lets the app sleep for long periods. Unfortunately, Android&apos;s primitive kill process <i class=" ">sometimes</i> leads to a known problem where the app is only partially shut down. The solution for Titanium apps is to set the <tt class=" ">alwaysRetainTaskState</tt> parameter in the <tt class=" ">AndroidManifest.xml</tt> file, as follows (this one is taken from the KitchenSink):    </p>
<div xmlns="http://www.w3.org/1999/xhtml" class="confbox programlisting scroll-unprocessed">
<div class="defaultnew syntaxhighlighter">
<div class="line"><code class="plain">&lt;activity android:configChanges=</code><code class="string">&quot;keyboardHidden|orientation&quot;</code><code class="plain"> android:label=</code><code class="string">&quot;KitchenSink&quot;</code><code class="plain"> android:name=</code><code class="string">&quot;.KitchensinkActivity&quot;</code><code class="plain"> android:alwaysRetainTaskState=</code><code class="string">&quot;true&quot;</code><code class="plain"> android:theme=</code><code class="string">&quot;@style/Theme.Titanium&quot;</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;intent-filter&gt;</code></div>
<div class="line"><code class="plain">    &lt;action android:name=</code><code class="string">&quot;android.intent.action.MAIN&quot;</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;category android:name=</code><code class="string">&quot;android.intent.category.LAUNCHER&quot;</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">  &lt;/intent-filter&gt;</code></div>
<div class="line"><code class="plain">&lt;/activity&gt;</code></div>
</div>
</div> <div class="confbox admonition admonition-note aui-message warning shadowed information-macro">
<p>
Be aware that this setting increases memory usage, so only enable it where your app is experiencing the problem.    </p>
</div>
</div>
</div>
</div>

</div>

</body>
</html>